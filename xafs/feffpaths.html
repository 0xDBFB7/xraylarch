

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>7.5. XAFS: Reading and using Feff Paths &mdash; larch 0.9.22 documentation</title>
    
    <link rel="stylesheet" href="../_static/larchdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.22',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="top" title="larch 0.9.22 documentation" href="../index.html" />
    <link rel="up" title="7. XAFS Analysis" href="index.html" />
    <link rel="next" title="7.6. XAFS: Fitting XAFS to Feff Paths" href="feffit.html" />
    <link rel="prev" title="7.4. XAFS: Fourier Transforms for XAFS" href="xafsft.html" /> 
  </head>
  <body>
<div style=" color: #c5daba;  text-align: left; height:100px; padding: 0px">
<table><tr><td width=0></td>
  <td width=25% padding=0>
    <a href="../index.html">
       <img src="../_static/larchcones.png" height=90px alt="larchcones"/>
    </a>
  </td><td width=75% padding=0>
      <font size=+4><a href="../index.html" style="color: #772211">
          Larch: X-ray Data Analysis   </a></font>
</td></tr></table>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="feffit.html" title="7.6. XAFS: Fitting XAFS to Feff Paths"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="xafsft.html" title="7.4. XAFS: Fourier Transforms for XAFS"
             accesskey="P">previous</a> |</li>
   <li><a href="../contents.html">contents</a>|&nbsp;</li>
   <li><a href="../downloads/index.html">downloads</a>|&nbsp;</li>
   <li><a href="../tutorial/index.html">tutorial</a>|&nbsp;</li>
   <li><a href="../data/index.html">data</a>|&nbsp;</li>
   <li><a href="../plotting/index.html">plot</a>|&nbsp;</li>
   <li><a href="../fitting/index.html">fit</a>|&nbsp;</li>
   <li><a href="index.html">XAFS</a>|&nbsp;</li>
   <li><a href="../xray/index.html">Xray Data</a>|&nbsp;</li>
   <li><a href="../xrf/index.html">XRF</a>|&nbsp;</li>

          <li><a href="index.html" accesskey="U">7. XAFS Analysis</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">7.5. XAFS: Reading and using Feff Paths</a><ul>
<li><a class="reference internal" href="#feffpath-and-feffpath-groups">7.5.1. <tt class="docutils literal"><span class="pre">feffpath()</span></tt> and FeffPath Groups</a></li>
<li><a class="reference internal" href="#path2chi-and-ff2chi-generating-for-a-feffpath">7.5.2. <tt class="docutils literal"><span class="pre">path2chi()</span></tt> and <tt class="docutils literal"><span class="pre">ff2chi()</span></tt>: Generating <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> for a FeffPath</a></li>
<li><a class="reference internal" href="#the-feffdat-group-full-details-of-the-feff-dat-file">7.5.3. The _feffdat Group: Full Details of the Feff.Dat File</a></li>
<li><a class="reference internal" href="#the-exafs-equation-using-feff-and-feffpath-groups">7.5.4. The EXAFS Equation using Feff and FeffPath Groups</a></li>
<li><a class="reference internal" href="#models-for-calculating">7.5.5. Models for Calculating <img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/></a></li>
<li><a class="reference internal" href="#example-reading-a-feff-file">7.5.6. Example:  Reading a FEFF file</a></li>
<li><a class="reference internal" href="#example-adding-feff-files">7.5.7. Example:  Adding FEFF files</a></li>
<li><a class="reference internal" href="#example-using-path-parameters-when-adding-feff-files">7.5.8. Example: Using Path Parameters when adding FEFF files</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="xafsft.html"
                        title="previous chapter">7.4. XAFS: Fourier Transforms for XAFS</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="feffit.html"
                        title="next chapter">7.6. XAFS: Fitting XAFS to Feff Paths</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/xafs/feffpaths.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-_xafs">
<span id="xafs-reading-and-using-feff-paths"></span><span id="xafs-feffpaths-sec"></span><h1>7.5. XAFS: Reading and using Feff Paths<a class="headerlink" href="#module-_xafs" title="Permalink to this headline">¶</a></h1>
<p>For modeling EXAFS data, Larch relies heavily on calculations of
theoretical XAFS spectra using FEFF.  Being able to run FEFF and use its
results is of fundamental importance for using Larch for fitting EXAFS
spectra.  While a complete description of FEFF (<span class="citation"><a class="reference internal" href="../biblio.html#citation-feff6-rehr">Rehr, Mustre&nbsp;de&nbsp;Leon, Zabinsky and Albers</a><span> </span><span>[</span><a class="reference internal" href="../biblio.html#citation-feff6-rehr">13</a><span>]</span></span>,
<span class="citation"><a class="reference internal" href="../biblio.html#citation-feff6-siz">Zabinsky, Rehr, Ankudinov, Albers and Eller</a><span> </span><span>[</span><a class="reference internal" href="../biblio.html#citation-feff6-siz">17</a><span>]</span></span>, <span class="citation"><a class="reference internal" href="../biblio.html#citation-rehralbers-rmp">Rehr and Albers</a><span> </span><span>[</span><a class="reference internal" href="../biblio.html#citation-rehralbers-rmp">12</a><span>]</span></span>) is beyond the scope of
this documentation, here we describe how to read the results from FEFF into
Larch.  The main interface for this is the <a class="reference internal" href="#_xafs.feffpath" title="_xafs.feffpath"><tt class="xref py py-func docutils literal"><span class="pre">feffpath()</span></tt></a> function that
reads FEFF <em>feffNNNN.dat</em> file and creates a FeffPath Group.</p>
<div class="section" id="feffpath-and-feffpath-groups">
<h2>7.5.1. <a class="reference internal" href="#_xafs.feffpath" title="_xafs.feffpath"><tt class="xref py py-func docutils literal"><span class="pre">feffpath()</span></tt></a> and FeffPath Groups<a class="headerlink" href="#feffpath-and-feffpath-groups" title="Permalink to this headline">¶</a></h2>
<p>The outputs from Feff for each path are complicated enough to need a
structured organization of data.  This is accomplished by providing a
special kind of a Larch Group -- a FeffPath Group which holds all the
information about a Feff Path, including the photo-electron scattering
amplitudes and phase-shifts needed to describe and calculate the EXAFS for
that Path.  A FeffPath Group is created with the <a class="reference internal" href="#_xafs.feffpath" title="_xafs.feffpath"><tt class="xref py py-func docutils literal"><span class="pre">feffpath()</span></tt></a>
group. For many uses a Feff Path can be treated as a &quot;black box&quot;, and
simply setting the adjustable Path Parameters and passing around these
Groups is sufficient for simulating and fitting EXAFS spectra.</p>
<p>At times it can be helpful to inspect and study the detailed components of
the Feff Path.  Since a FeffPath Group is a regular Larch Group, all the
data can be read and viewed.  A FeffPath Group has the components listed in
the <a class="reference internal" href="#xafs-pathparams-table"><em>Table of Feff Path Parameters</em></a>.  This
includes the <em>Adjustable Numerical Path Parameters</em> -- the values of which
can be changed to affect the calculated EXAFS for the Path -- as well as
the arrays for <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> and <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/> and several other attributes.
Since this Group is used to calculate <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> for the path, many of
the components need to be in place and holding the expected values so that
the calculation can be done correctly, Due to Larch's flexibility, it is
possible to delete, overwrite, or put inappropriate values into the
components of a FeffPath Group, and care must be taken to avoid this.</p>
<blockquote id="xafs-pathparams-table">
<span id="index-0"></span><div><p>Table of FeffPath Parameters, including the Path
Parameters used in the EXAFS equation.  The attributes here are
arranged by category.  The <em>Info</em> attributes are informational only.
The two <em>Numerical</em> attributes <tt class="docutils literal"><span class="pre">reff</span></tt> and <tt class="docutils literal"><span class="pre">nleg</span></tt> are used in the
EXAFS equation but are meant to be constants and their values should
not be changed.  The <em>Adjustable</em> attributes are the standard
Adjustable, Numerical Path Parameters that can be changed to affect the
resulting EXAFS <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/>.  These can be set either as constant
values or fitting Parameters as defined by <a class="reference internal" href="../fitting/parameters.html#_math.param" title="_math.param"><tt class="xref py py-func docutils literal"><span class="pre">_math.param()</span></tt></a>.  The
<em>Output array</em> attributes are the arrays output from <a class="reference internal" href="#_xafs.path2chi" title="_xafs.path2chi"><tt class="xref py py-func docutils literal"><span class="pre">path2chi()</span></tt></a>.
Finally, the sub-group <tt class="docutils literal"><span class="pre">_feffdat</span></tt> contains the low-level data as read
directly from the <em>feffNNNN.dat</em> file, which is detailed in the next
section, <a class="reference internal" href="#xafs-feffdat-sec">7.5.3</a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute name</th>
<th class="head">category</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>filename</td>
<td>Info</td>
<td>name of <em>feffNNNN.dat</em> file</td>
</tr>
<tr class="row-odd"><td>label</td>
<td>Info</td>
<td>path description</td>
</tr>
<tr class="row-even"><td>geom</td>
<td>Info</td>
<td>path geometry: list of (symbol, ipot, x, y, z)</td>
</tr>
<tr class="row-odd"><td>reff</td>
<td>Numerical</td>
<td><img class="math" src="../_images/math/15493fcc792ba610986fbea3a27f4cef6740f314.png" alt="R_{\rm eff}"/>, nominal path length</td>
</tr>
<tr class="row-even"><td>nleg</td>
<td>Numerical</td>
<td>number of path legs (1+number of scatterers)</td>
</tr>
<tr class="row-odd"><td>degen</td>
<td>Adjustable</td>
<td><img class="math" src="../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/>, path degeneracy</td>
</tr>
<tr class="row-even"><td>s02</td>
<td>Adjustable</td>
<td><img class="math" src="../_images/math/fc923d7c827eca7b3f461463e11c982710c3bcb1.png" alt="S_0^2"/>, amplitude reduction factor</td>
</tr>
<tr class="row-odd"><td>e0</td>
<td>Adjustable</td>
<td><img class="math" src="../_images/math/8a52f40afedf1c8727d71b0ad5a7ea0a7119b088.png" alt="E_0"/>, energy origin</td>
</tr>
<tr class="row-even"><td>deltar</td>
<td>Adjustable</td>
<td><img class="math" src="../_images/math/3b949109c5d7b0ce70c280f17cfc63036d7ccc96.png" alt="\Delta R"/>, shift in path length</td>
</tr>
<tr class="row-odd"><td>sigma2</td>
<td>Adjustable</td>
<td><img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/>, mean-square displacement</td>
</tr>
<tr class="row-even"><td>third</td>
<td>Adjustable</td>
<td><img class="math" src="../_images/math/94aaab012b431d7695fa1ae72d7a88b05baf09f7.png" alt="c_3"/>,  third cumulant</td>
</tr>
<tr class="row-odd"><td>fourth</td>
<td>Adjustable</td>
<td><img class="math" src="../_images/math/67cff48f601f12a5b71afe302e7c3487f7535731.png" alt="c_4"/>, the fourth cumulant</td>
</tr>
<tr class="row-even"><td>ei</td>
<td>Adjustable</td>
<td><img class="math" src="../_images/math/f8f358aa01478e43f1a663db574b83f88d7be478.png" alt="E_i"/>, imaginary energy shift.</td>
</tr>
<tr class="row-odd"><td>k</td>
<td>Output array</td>
<td><img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>, photo-electron wavenumber</td>
</tr>
<tr class="row-even"><td>chi</td>
<td>Output array</td>
<td><img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/>, the EXAFS</td>
</tr>
<tr class="row-odd"><td>chi_imag</td>
<td>Output array</td>
<td><img class="math" src="../_images/math/eef370fe28e0da6dd00093372bac872a58f421bb.png" alt="\rm{Im}(\chi)"/>, imaginary EXAFS</td>
</tr>
<tr class="row-even"><td>p</td>
<td>Output array</td>
<td><img class="math" src="../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/>, complex photo-electron wavenumber</td>
</tr>
<tr class="row-odd"><td>_feffdat</td>
<td>Group</td>
<td>a Group containing raw data from <em>feffNNNN.dat</em></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="function">
<dt id="_xafs.feffpath">
<tt class="descclassname">_xafs.</tt><tt class="descname">feffpath</tt><big>(</big><em>filename</em>, <em>label=None</em>, <em>s02=None</em>, <em>degen=None</em>, <em>e0=None</em>, <em>deltar=None</em>, <em>sigma2=None</em>, <em>...</em><big>)</big><a class="headerlink" href="#_xafs.feffpath" title="Permalink to this definition">¶</a></dt>
<dd><p>create a FeffPath Group from a <em>feffNNNN.dat</em> file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> -- name (full path of) <em>feffNNNN.dat</em> file</li>
<li><strong>label</strong> -- label for path   [file name]</li>
<li><strong>degen</strong> -- path degeneracy, <img class="math" src="../_images/math/fc97ef67268cd4e91bacdf12b8901d7036c9a056.png" alt="N"/> [taken from file]</li>
<li><strong>s02</strong> -- <img class="math" src="../_images/math/fc923d7c827eca7b3f461463e11c982710c3bcb1.png" alt="S_0^2"/>    value or parameter [1.0]</li>
<li><strong>e0</strong> -- <img class="math" src="../_images/math/8a52f40afedf1c8727d71b0ad5a7ea0a7119b088.png" alt="E_0"/>      value or parameter [0.0]</li>
<li><strong>deltar</strong> -- <img class="math" src="../_images/math/3b949109c5d7b0ce70c280f17cfc63036d7ccc96.png" alt="\Delta R"/> value or parameter [0.0]</li>
<li><strong>sigma2</strong> -- <img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/> value or parameter [0.0]</li>
<li><strong>third</strong> -- <img class="math" src="../_images/math/94aaab012b431d7695fa1ae72d7a88b05baf09f7.png" alt="c_3"/>      value or parameter [0.0]</li>
<li><strong>fourth</strong> -- <img class="math" src="../_images/math/67cff48f601f12a5b71afe302e7c3487f7535731.png" alt="c_4"/>      value or parameter [0.0]</li>
<li><strong>ei</strong> -- <img class="math" src="../_images/math/f8f358aa01478e43f1a663db574b83f88d7be478.png" alt="E_i"/>      value or parameter [0.0]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a FeffPath Group.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>For all the options described above with <strong>value or parameter</strong> either a
numerical value or a Parameter (as created by <a class="reference internal" href="../fitting/parameters.html#_math.param" title="_math.param"><tt class="xref py py-func docutils literal"><span class="pre">_math.param()</span></tt></a>) can be given.</p>
</div>
<div class="section" id="path2chi-and-ff2chi-generating-for-a-feffpath">
<h2>7.5.2. <a class="reference internal" href="#_xafs.path2chi" title="_xafs.path2chi"><tt class="xref py py-func docutils literal"><span class="pre">path2chi()</span></tt></a> and <a class="reference internal" href="#_xafs.ff2chi" title="_xafs.ff2chi"><tt class="xref py py-func docutils literal"><span class="pre">ff2chi()</span></tt></a>: Generating <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> for a FeffPath<a class="headerlink" href="#path2chi-and-ff2chi-generating-for-a-feffpath" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="_xafs.path2chi">
<tt class="descclassname">_xafs.</tt><tt class="descname">path2chi</tt><big>(</big><em>path</em>, <em>paramgroup=None</em>, <em>kmax=None</em>, <em>kstep=0.05</em>, <em>k=None</em><big>)</big><a class="headerlink" href="#_xafs.path2chi" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> for a single Feff Path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> -- a FeffPath Group</li>
<li><strong>paramgroup</strong> -- a Parameter Group for calculating Path Parameters [<tt class="docutils literal"><span class="pre">None</span></tt>]</li>
<li><strong>kmax</strong> -- maximum <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> value for <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/> calculation [20].</li>
<li><strong>kstep</strong> -- step in <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> value for <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/> calculation [0.05].</li>
<li><strong>k</strong> -- explicit array of <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> values to calculate <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">None</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>If <tt class="docutils literal"><span class="pre">k</span></tt> is specified, that will be used as the set of <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> values at which
to calculate <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/>.  If not given, the values of <tt class="docutils literal"><span class="pre">kstep</span></tt> and <tt class="docutils literal"><span class="pre">kmax</span></tt>
will be used to construct a uniformly-spaced array of <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> values starting
at 0 and extending to (and including) <tt class="docutils literal"><span class="pre">kmax</span></tt>.</p>
<p>The calculated <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/> array is placed in the Feff Path Group <tt class="docutils literal"><span class="pre">path</span></tt> as
<tt class="docutils literal"><span class="pre">path.chi</span></tt>.  In addition calculated arrays for <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>, <img class="math" src="../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/>, and
<img class="math" src="../_images/math/eef370fe28e0da6dd00093372bac872a58f421bb.png" alt="\rm{Im}(\chi)"/> are placed in the variables <tt class="docutils literal"><span class="pre">path.k</span></tt>, <tt class="docutils literal"><span class="pre">path.p</span></tt>, and
<tt class="docutils literal"><span class="pre">path.chi_imag</span></tt>, respectively.  See <a class="reference internal" href="#xafs-exafsequation-sec">7.5.4</a> for the
detailed definitions of the quantities.</p>
<p>If specified, <tt class="docutils literal"><span class="pre">paramgroup</span></tt> is used as the Parameter Group -- the group
used for evaluating parameter expressions (ie, constraints using named
variables).  This is similar to the use for <a class="reference internal" href="../fitting/minimize.html#_math.minimize" title="_math.minimize"><tt class="xref py py-func docutils literal"><span class="pre">_math.minimize()</span></tt></a> as discussed
in <a class="reference internal" href="../fitting/parameters.html#fitting-namespace-sec"><em>Namespaces for algebraic expressions</em></a>.</p>
<dl class="function">
<dt id="_xafs.ff2chi">
<tt class="descclassname">_xafs.</tt><tt class="descname">ff2chi</tt><big>(</big><em>pathlist</em>, <em>paramgroup=None</em>, <em>group=None</em>, <em>k=None</em>, <em>kmax=None</em>, <em>kstep=0.05</em><big>)</big><a class="headerlink" href="#_xafs.ff2chi" title="Permalink to this definition">¶</a></dt>
<dd><p>sum the <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> for a list of FeffPath Groups.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pathlist</strong> -- a list of FeffPath Groups</li>
<li><strong>paramgroup</strong> -- a Parameter Group for calculating Path Parameters [<tt class="docutils literal"><span class="pre">None</span></tt>]</li>
<li><strong>group</strong> -- a Group to which the outputs are written  [<tt class="docutils literal"><span class="pre">None</span></tt>]</li>
<li><strong>kmax</strong> -- maximum <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> value for <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/> calculation [20].</li>
<li><strong>kstep</strong> -- step in <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> value for <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/> calculation [0.05].</li>
<li><strong>k</strong> -- explicit array of <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> values to calculate <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">None</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This essentially calls <a class="reference internal" href="#_xafs.path2chi" title="_xafs.path2chi"><tt class="xref py py-func docutils literal"><span class="pre">path2chi()</span></tt></a> for each of the paths in the
<tt class="docutils literal"><span class="pre">pathlist</span></tt> and writes the resulting arrays for <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> and <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/> the
sum of <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/> for all the paths) to <tt class="docutils literal"><span class="pre">group.k</span></tt> and <tt class="docutils literal"><span class="pre">group.chi</span></tt>.</p>
</div>
<div class="section" id="the-feffdat-group-full-details-of-the-feff-dat-file">
<span id="xafs-feffdat-sec"></span><span id="index-1"></span><h2>7.5.3. The _feffdat Group: Full Details of the Feff.Dat File<a class="headerlink" href="#the-feffdat-group-full-details-of-the-feff-dat-file" title="Permalink to this headline">¶</a></h2>
<p>Each FeffPath Group will have a <tt class="docutils literal"><span class="pre">_feffdat</span></tt> sub-group which contains the
data from the underlying <em>feffNNNN.dat</em> file for the results of the Feff
calculation.  Many of the components of this group are used for the
calculations of <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> for that Path, though some (such as
<tt class="docutils literal"><span class="pre">exch</span></tt> and <tt class="docutils literal"><span class="pre">edge</span></tt>) are kept only for informational purposes.  Some
components from this sub-group (notably as <tt class="docutils literal"><span class="pre">geom</span></tt> and <tt class="docutils literal"><span class="pre">nleg</span></tt>) are
copied into the FeffPath Group.  As with the FeffPath Group, this Group has
an expected set of components that should be treated as read-only unless
you really know what you're doing.</p>
<blockquote id="xafs-feffdat-table">
<div><p>Table of Feff.dat components.  Listed here is the component read from
the Feff.dat file and stored in the <tt class="docutils literal"><span class="pre">_feffdat</span></tt> group for each FeffPath.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>amp</td>
<td>array: total amplitude,   <img class="math" src="../_images/math/dc9ceb3d964e0dd8dc21a9b509aec8e8bb0ea172.png" alt="F_{\rm eff}(k)"/></td>
</tr>
<tr class="row-odd"><td>degen</td>
<td>path degeneracy (coordination number)</td>
</tr>
<tr class="row-even"><td>edge</td>
<td>energy threshold relative to atomic valu (a poor estimate)</td>
</tr>
<tr class="row-odd"><td>exch</td>
<td>string describing electronic exchange model</td>
</tr>
<tr class="row-even"><td>filename</td>
<td>File name</td>
</tr>
<tr class="row-odd"><td>gam_ch</td>
<td>core level energy width</td>
</tr>
<tr class="row-even"><td>geom</td>
<td>path geometry: list of (Symbol, Z, ipot, x, y, z)</td>
</tr>
<tr class="row-odd"><td>k</td>
<td>array: k values, <img class="math" src="../_images/math/d5ddb392ea10551ae9362e74a91a808ca21c042d.png" alt="k_{\rm feff}"/></td>
</tr>
<tr class="row-even"><td>kf</td>
<td>k value at Fermi level</td>
</tr>
<tr class="row-odd"><td>lam</td>
<td>array: mean-free path,  <img class="math" src="../_images/math/9da1ca06f254e28e313f89305d77b9824c2e81ad.png" alt="\lambda(k)"/></td>
</tr>
<tr class="row-even"><td>mag_feff</td>
<td>array: magnitude of Feff</td>
</tr>
<tr class="row-odd"><td>mu</td>
<td>Fermi level, eV</td>
</tr>
<tr class="row-even"><td>pha</td>
<td>array: total phase shift, <img class="math" src="../_images/math/c60f21ac85a002e1af86e871193d4ac8dc0fabde.png" alt="\delta(k)"/></td>
</tr>
<tr class="row-odd"><td>pha_feff</td>
<td>array: scattring phase shift</td>
</tr>
<tr class="row-even"><td>potentials</td>
<td>path potentials: list of (ipot, z, r_MuffinTin, r_Norman)</td>
</tr>
<tr class="row-odd"><td>real_phc</td>
<td>array: central atom phase shift</td>
</tr>
<tr class="row-even"><td>red_fact</td>
<td>array: amplitude reduction factor</td>
</tr>
<tr class="row-odd"><td>rep</td>
<td>array: real part of p, <img class="math" src="../_images/math/62a9ce9672802009c1533f2b5a5cd183a9f8bc48.png" alt="p_{\rm real}(k)"/></td>
</tr>
<tr class="row-even"><td>rnorman</td>
<td>Norman radius</td>
</tr>
<tr class="row-odd"><td>rs_int</td>
<td>interstitial radius</td>
</tr>
<tr class="row-even"><td>title</td>
<td>user title</td>
</tr>
<tr class="row-odd"><td>version</td>
<td>Feff version</td>
</tr>
<tr class="row-even"><td>vint</td>
<td>interstitial potential</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The arrays from the data columns of the Feff data file break up the
amplitude and phase into two components (essentially as one for the central
atom and one for the scattering atoms) that are simply added together.
Thus <tt class="docutils literal"><span class="pre">amp</span></tt> = <tt class="docutils literal"><span class="pre">red_fact</span></tt> + <tt class="docutils literal"><span class="pre">mag_feff</span></tt> and the sum is used as
<img class="math" src="../_images/math/dc9ceb3d964e0dd8dc21a9b509aec8e8bb0ea172.png" alt="F_{\rm eff}(k)"/>.  Similarly, <tt class="docutils literal"><span class="pre">pha</span></tt> = <tt class="docutils literal"><span class="pre">real_phc</span></tt> + <tt class="docutils literal"><span class="pre">pha_feff</span></tt>
and the sum is used as <img class="math" src="../_images/math/c60f21ac85a002e1af86e871193d4ac8dc0fabde.png" alt="\delta(k)"/>.</p>
</div>
<div class="section" id="the-exafs-equation-using-feff-and-feffpath-groups">
<span id="xafs-exafsequation-sec"></span><span id="index-2"></span><h2>7.5.4. The EXAFS Equation using Feff and FeffPath Groups<a class="headerlink" href="#the-exafs-equation-using-feff-and-feffpath-groups" title="Permalink to this headline">¶</a></h2>
<p>Now we are ready to write down the full EXAFS equation used for a Feff Path
using the terms defined above in the
<a class="reference internal" href="#xafs-pathparams-table"><em>Table of Feff Path Parameters</em></a>
and the <a class="reference internal" href="#xafs-feffdat-table"><em>Table of Feff.Dat Components</em></a>.  One of the trickier concepts is that we are
evaluating at experimental values of <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> while the Feff calculation
is tabulated on its own set of <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> values and we may need to apply an
energy shift of <img class="math" src="../_images/math/8a52f40afedf1c8727d71b0ad5a7ea0a7119b088.png" alt="E_0"/> to the Feff calculation.  Thus, first we find
<img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> as</p>
<div class="math">
<p><img src="../_images/math/e843cf17b6b2b22b09f913d2e6af861f04ba4e03.png" alt="k = \sqrt{k_{\rm feff}^2  - {2m_e E_0}/{\hbar^2} }"/></p>
</div><p>where <img class="math" src="../_images/math/8a52f40afedf1c8727d71b0ad5a7ea0a7119b088.png" alt="E_0"/> is taken from the <tt class="docutils literal"><span class="pre">e0</span></tt> parameter and <img class="math" src="../_images/math/426172f4bcda36a7158cc9a6ea45ef149e13aa43.png" alt="k_{\rm
feff}"/> are the <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> values from Feff (<tt class="docutils literal"><span class="pre">_feffdat.k</span></tt>).  This shifted
<img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> will be used to access the <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> dependent values from the
Feff arrays.  Next, we note that we need the complex wavenumber, defined as</p>
<div class="math">
<p><img src="../_images/math/6a0be16405df5030333c88dc3d9f24975db78cab.png" alt="p = p' + i p'' = \sqrt{ \big[ p_{\rm real}(k) - i / \lambda(k) \big]^2 - i \,
     2 m_e E_i /{\hbar^2} }"/></p>
</div><p>where <img class="math" src="../_images/math/ebc667a6b48c0f57dd85e1e4479e308b711c0b37.png" alt="p_{\rm real}"/> and <img class="math" src="../_images/math/ce4588fd900d02afcbd260bc07f54cce49a7dc4a.png" alt="\lambda"/> are the values from Feff
(<tt class="docutils literal"><span class="pre">_feffdat.rep</span></tt> and <tt class="docutils literal"><span class="pre">_feffdat.lam</span></tt>) and <img class="math" src="../_images/math/f8f358aa01478e43f1a663db574b83f88d7be478.png" alt="E_i"/> is the complex energy
shift from the parameter <tt class="docutils literal"><span class="pre">ei</span></tt>.  Note that <img class="math" src="../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/> is used as the complex
number following the physics literature, while within Larch <tt class="docutils literal"><span class="pre">1j</span></tt> is used.
The complex wavenumber <img class="math" src="../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/> includes a self-energy term (due to the
presence of multiple electrons in the system) and is meant to be referenced
to the absorption threshod while <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> is meant to be referenced to the
Fermi level.  Thus <img class="math" src="../_images/math/4c9ec62dd8f94ca61489453f6c67271591a6d003.png" alt="p_{\rm real} \approx \Sigma + k"/>, where
<img class="math" src="../_images/math/c8f77e3035db5fe9a4975967750ac1a6454bda8c.png" alt="\Sigma"/> is a small but usually positive offset.  Within the EXAFS
equation, <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> is used to restore the calculation of <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> as
done by Feff, while <img class="math" src="../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/> is used to apply alterations to <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/>
as for disorder terms.</p>
<p>The EXAFS equation used for constructing <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> from a Feff
calculation is then</p>
<div class="math">
<p><img src="../_images/math/c998bfa74d71a14018ee98799599e0c64a888fbe.png" alt="\begin{eqnarray*}
\chi(k) = &amp; {\rm Im}\Bigl[
   {\displaystyle{
           \frac{f_{\rm eff(k)} N S_0^2} {k(R_{\rm eff} + \Delta R)^2} }
         \enskip\exp(-2p''R_{\rm reff} - 2p^2\sigma^2 +
         \textstyle{\frac{2}{3}}p^4 c_4)}  \hspace{18mm} \,\, \\
         &amp;{\times  \exp \bigl\{ i\big[  2kR_{\rm eff} + \delta(k)
         + 2p(\Delta R - 2\sigma^2/R_{\rm eff} )
         - \textstyle{\frac{4}{3}} p^3 c_3  \big]  \bigr\} }
        \Bigr]    \\
\end{eqnarray*}"/></p>
</div><p>where the terms are all defined above. Again, note that <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> is used to
reconstruct the unaltered EXAFS from the Feff.dat file, and the complex
<img class="math" src="../_images/math/36f73fc1312ee0349b3f3a0f3bd9eb5504339011.png" alt="p"/> is used for the terms adding the effects of disorder.  Also note
that <img class="math" src="../_images/math/ef804e2f03eac13c447a49c25c8b57bf936ceefb.png" alt="p''"/> becomes <img class="math" src="../_images/math/9da1ca06f254e28e313f89305d77b9824c2e81ad.png" alt="\lambda(k)"/> for <img class="math" src="../_images/math/9fe46701fb538f53997b9a8c6ec67c44ee032593.png" alt="E_i = 0"/>, and is the
generalization of the mean-free-path contribution.  The terms <img class="math" src="../_images/math/08842238d3403fa09d4313be1d356168b7f360e1.png" alt="\Delta
R"/>, <img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/>, <img class="math" src="../_images/math/94aaab012b431d7695fa1ae72d7a88b05baf09f7.png" alt="c_3"/>, and <img class="math" src="../_images/math/67cff48f601f12a5b71afe302e7c3487f7535731.png" alt="c_4"/> are the first four
cumulants of the atomic pair distribution for the selected path. The
additional term <img class="math" src="../_images/math/f25bca85d065ff40a783a30890c018517e48b646.png" alt="-2p(2\sigma^2/R_{\rm eff})"/> in the phase is a
correction to the cumulant expansion due to the averaging over the
<img class="math" src="../_images/math/5a7a21ed469f84a209720ee21ba26052d77cdbc5.png" alt="1/R^2"/> term in the EXAFS equation.</p>
<p>The use of the cumulant expansion here does not necessarily imply that
systems must be ordered enough for their atomic distributios to modeled by
the cumulant expansion.  All that is required is that contribution from each
path be ordered enough for the cumulant expansion to work.  A highly
disordered system can be modeled by applying a more complex weighting to a
set of paths -- that is, a histogram of paths.</p>
<span class="target" id="index-3"></span></div>
<div class="section" id="models-for-calculating">
<span id="xafs-sigma2calcs-sec"></span><span id="index-4"></span><h2>7.5.5. Models for Calculating <img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/><a class="headerlink" href="#models-for-calculating" title="Permalink to this headline">¶</a></h2>
<p>The value for <img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/> in the EXAFS equation gets a lot of
attention in the EXAFS literature, as it is often the only term used to
account for thermal and static disorder in an ensemble of Paths that makes
up a full EXAFS spectra.  Borrowing from Feff (see <span class="citation"><a class="reference internal" href="../biblio.html#citation-feff6-rehr">Rehr, Mustre&nbsp;de&nbsp;Leon, Zabinsky and Albers</a><span> </span><span>[</span><a class="reference internal" href="../biblio.html#citation-feff6-rehr">13</a><span>]</span></span>,
<span class="citation"><a class="reference internal" href="../biblio.html#citation-sevillano">Sevillano, Meuth and Rehr</a><span> </span><span>[</span><a class="reference internal" href="../biblio.html#citation-sevillano">14</a><span>]</span></span> and <span class="citation"><a class="reference internal" href="../biblio.html#citation-rehralbers-rmp">Rehr and Albers</a><span> </span><span>[</span><a class="reference internal" href="../biblio.html#citation-rehralbers-rmp">12</a><span>]</span></span>) Larch provides two
functions that use simple models to calculate <img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/> for a Path.
Both functions, <a class="reference internal" href="#_xafs.sigma2_eins" title="_xafs.sigma2_eins"><tt class="xref py py-func docutils literal"><span class="pre">sigma2_eins()</span></tt></a> and <a class="reference internal" href="#_xafs.sigma2_debye" title="_xafs.sigma2_debye"><tt class="xref py py-func docutils literal"><span class="pre">sigma2_debye()</span></tt></a> take arguments
of sample temperature, a characteristic temperature, and a FeffPath, and
return a value of <img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/>.  These are known to appy reasonably
well to very simple systems (such as metals and solids with few atomic
components), and less well to complex systems, including anything with
organic ligands.</p>
<dl class="function">
<dt id="_xafs.sigma2_eins">
<tt class="descclassname">_xafs.</tt><tt class="descname">sigma2_eins</tt><big>(</big><em>t</em>, <em>theta</em>, <em>path=None</em><big>)</big><a class="headerlink" href="#_xafs.sigma2_eins" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate <img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/> in the Einstein model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> -- sample temperature (in K)</li>
<li><strong>theta</strong> -- Einstein temperature (in K)</li>
<li><strong>path</strong> -- a FeffPath Group  [<tt class="docutils literal"><span class="pre">None</span></tt>]</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <cite>path</cite> argument can be left <tt class="docutils literal"><span class="pre">None</span></tt>.  This will try to use the
''current FeffData group&quot;, (<cite>_sys.paramGroup._feffdat</cite>), which is updated
during fits with <a class="reference internal" href="feffit.html#_xafs.feffit" title="_xafs.feffit"><tt class="xref py py-func docutils literal"><span class="pre">feffit()</span></tt></a> and when summing paths with <a class="reference internal" href="#_xafs.ff2chi" title="_xafs.ff2chi"><tt class="xref py py-func docutils literal"><span class="pre">ff2chi()</span></tt></a>.</p>
<dl class="function">
<dt id="_xafs.sigma2_debye">
<tt class="descclassname">_xafs.</tt><tt class="descname">sigma2_debye</tt><big>(</big><em>t</em>, <em>theta</em>, <em>path=None</em><big>)</big><a class="headerlink" href="#_xafs.sigma2_debye" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate <img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/> in the Debye model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>t</strong> -- sample temperature (in K)</li>
<li><strong>theta</strong> -- Debye temperature (in K)</li>
<li><strong>path</strong> -- a FeffPath Group  [<tt class="docutils literal"><span class="pre">None</span></tt>]</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>As with <tt class="xref py py-func docutils literal"><span class="pre">sigma2_eins,</span> <span class="pre">the</span> <span class="pre">`path()</span></tt> argument can be left <tt class="docutils literal"><span class="pre">None</span></tt>, and the
''current FeffData group&quot;, (<cite>_sys.paramGroup._feffdat</cite>), will be used.</p>
</div>
<div class="section" id="example-reading-a-feff-file">
<h2>7.5.6. Example:  Reading a FEFF file<a class="headerlink" href="#example-reading-a-feff-file" title="Permalink to this headline">¶</a></h2>
<p>Here we simply read a <em>feffNNNN.dat</em> file and display its components, and
calculate <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/> for this path with two different values of
<img class="math" src="../_images/math/741fb9098efcb98055f467f87630a5d0ca599b6b.png" alt="\sigma^2"/>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## examples/feffit/doc_feffdat1.lar</span>

<span class="n">fname</span> <span class="o">=</span> <span class="s">&#39;feff0001.dat&#39;</span>
<span class="n">path1</span> <span class="o">=</span> <span class="n">feffpath</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

<span class="n">path2chi</span><span class="p">(</span><span class="n">path1</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">path1</span><span class="p">)</span>


<span class="n">newplot</span><span class="p">(</span><span class="n">path1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">path1</span><span class="o">.</span><span class="n">chi</span><span class="o">*</span><span class="n">path1</span><span class="o">.</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s">r&#39; $ k \rm\, (\AA^{-1})$&#39;</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="s">r&#39;$ k^2\chi(k)$&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">r&#39;$\sigma^2 = 0$&#39;</span><span class="p">,</span> <span class="n">show_legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s">r&#39;$\chi(k)$ from </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">)</span>

<span class="n">path1</span><span class="o">.</span><span class="n">sigma2</span> <span class="o">=</span> <span class="mf">0.002</span>

<span class="n">path2chi</span><span class="p">(</span><span class="n">path1</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">path1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">path1</span><span class="o">.</span><span class="n">chi</span><span class="o">*</span><span class="n">path1</span><span class="o">.</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">r&#39;$\sigma^2 = 0.002$&#39;</span><span class="p">)</span>

<span class="c">## end examples/feffit/doc_feffdat1.lar</span>
</pre></div>
</div>
<p>The output of this looks like this:</p>
<div class="highlight-python"><pre>== FeffPath Group feff0001.dat: 16 symbols ==
  _feffdat: &lt;Feff.dat File Group: feff0001.dat&gt;
  chi: array&lt;shape=(401,), type=dtype('float64')&gt;
  chi_imag: array&lt;shape=(401,), type=dtype('float64')&gt;
  degen: 12.0
  deltar: 0
  e0: 0
  ei: 0
  filename: 'feff0001.dat'
  fourth: 0
  geom: [('Cu', 29, 0, 0.0, 0.0, 0.0), ('Cu', 29, 1, 0.0, -1.8016, 1.8016)]
  k: array&lt;shape=(401,), type=dtype('float64')&gt;
  label: 'feff0001.dat'
  p: array&lt;shape=(401,), type=dtype('complex128')&gt;
  s02: 1
  sigma2: 0
  third: 0</pre>
</div>
<p>After the initial read, the values of <tt class="docutils literal"><span class="pre">k</span></tt>, <tt class="docutils literal"><span class="pre">p</span></tt>, <tt class="docutils literal"><span class="pre">chi</span></tt>, and
<tt class="docutils literal"><span class="pre">chi_imag</span></tt> are set to <tt class="docutils literal"><span class="pre">None</span></tt>, and are not calculated until
<a class="reference internal" href="#_xafs.path2chi" title="_xafs.path2chi"><tt class="xref py py-func docutils literal"><span class="pre">path2chi()</span></tt></a> is called.</p>
<div class="figure align-center" id="xafs-fig12">
<a class="reference external image-reference" href="../_images/feffdat_example1.png"><img alt="../_images/feffdat_example1.png" src="../_images/feffdat_example1.png" style="width: 65%;" /></a>
<p class="caption"><strong>Figure 7.12:</strong> Calculations of <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> for a Feff Path.</p>
</div>
<p>We can also use the data from the <tt class="docutils literal"><span class="pre">_feffdat</span></tt> group to look at the
individual scattering components.  Thus to look at the scattering amplitude
and mean-free-path for a particular scattering path, you could use a script
like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## examples/feffit/doc_feffdat2.lar</span>

<span class="n">fname</span> <span class="o">=</span> <span class="s">&#39;feff0001.dat&#39;</span>
<span class="n">path1</span> <span class="o">=</span> <span class="n">feffpath</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

<span class="n">newplot</span><span class="p">(</span><span class="n">path1</span><span class="o">.</span><span class="n">_feffdat</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">path1</span><span class="o">.</span><span class="n">_feffdat</span><span class="o">.</span><span class="n">amp</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s">r&#39; $ k \rm\, (\AA^{-1})$&#39;</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="s">r&#39;$ |F_{\rm eff}(k)|$&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">r&#39;amp&#39;</span><span class="p">,</span> <span class="n">show_legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s">r&#39;components of _feffdat for </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">fname</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">path1</span><span class="o">.</span><span class="n">_feffdat</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">path1</span><span class="o">.</span><span class="n">_feffdat</span><span class="o">.</span><span class="n">lam</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">,</span>
     <span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
     <span class="n">label</span> <span class="o">=</span> <span class="s">r&#39;lam&#39;</span><span class="p">,</span> <span class="n">y2label</span><span class="o">=</span><span class="s">r&#39;$ \lambda(k) \rm\, (\AA)$&#39;</span><span class="p">)</span>

<span class="c">## end examples/feffit/doc_feffdat2.lar</span>
</pre></div>
</div>
<p>which will produce a plot like this:</p>
<div class="figure align-center" id="xafs-fig13">
<a class="reference external image-reference" href="../_images/feffdat_example2.png"><img alt="../_images/feffdat_example2.png" src="../_images/feffdat_example2.png" style="width: 65%;" /></a>
<p class="caption"><strong>Figure 7.13:</strong> Components of <tt class="docutils literal"><span class="pre">_feffdat</span></tt> group for a Feff Path.</p>
</div>
<p>You can see here that the arrays in the <tt class="docutils literal"><span class="pre">_feffdat</span></tt> group are sampled at
varying <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> spacing, and that this spacing becomes fairly large at
high <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>.</p>
</div>
<div class="section" id="example-adding-feff-files">
<h2>7.5.7. Example:  Adding FEFF files<a class="headerlink" href="#example-adding-feff-files" title="Permalink to this headline">¶</a></h2>
<p>Now, we add some FEFF files together, applying some path parameters.  The
example is actually very similar to the one above except that we use
<a class="reference internal" href="#_xafs.ff2chi" title="_xafs.ff2chi"><tt class="xref py py-func docutils literal"><span class="pre">ff2chi()</span></tt></a> to create a <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> from a list of paths, and put
the result into its own group.  Thus:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## examples/feffit/doc_feffdat3.lar</span>

<span class="c"># read some paths</span>
<span class="n">path1</span> <span class="o">=</span> <span class="n">feffpath</span><span class="p">(</span><span class="s">&#39;feff_feo01.dat&#39;</span><span class="p">)</span>
<span class="n">path2</span> <span class="o">=</span> <span class="n">feffpath</span><span class="p">(</span><span class="s">&#39;feff_feo02.dat&#39;</span><span class="p">)</span>
<span class="n">path3</span> <span class="o">=</span> <span class="n">feffpath</span><span class="p">(</span><span class="s">&#39;feff_feo03.dat&#39;</span><span class="p">)</span>
<span class="n">path4</span> <span class="o">=</span> <span class="n">feffpath</span><span class="p">(</span><span class="s">&#39;feff_feo04.dat&#39;</span><span class="p">)</span>
<span class="n">path5</span> <span class="o">=</span> <span class="n">feffpath</span><span class="p">(</span><span class="s">&#39;feff_feo05.dat&#39;</span><span class="p">)</span>

<span class="c"># apply an e0 shift and s02 to all paths:</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">,</span> <span class="n">path3</span><span class="p">,</span> <span class="n">path4</span><span class="p">,</span> <span class="n">path5</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">e0</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>
    <span class="n">p</span><span class="o">.</span><span class="n">s02</span> <span class="o">=</span>  <span class="mf">0.9</span>
<span class="n">endfor</span>

<span class="n">path1</span><span class="o">.</span><span class="n">sigma2</span> <span class="o">=</span> <span class="mf">0.003</span>
<span class="n">path2</span><span class="o">.</span><span class="n">sigma2</span> <span class="o">=</span> <span class="mf">0.004</span>
<span class="n">path3</span><span class="o">.</span><span class="n">sigma2</span> <span class="o">=</span> <span class="mf">0.006</span>
<span class="n">path4</span><span class="o">.</span><span class="n">sigma2</span> <span class="o">=</span> <span class="mf">0.008</span>
<span class="n">path5</span><span class="o">.</span><span class="n">sigma2</span> <span class="o">=</span> <span class="mf">0.008</span>
<span class="n">mysum</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;FeO sum of paths 1,2,3,4,5&#39;</span><span class="p">)</span>

<span class="n">ff2chi</span><span class="p">([</span><span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">,</span> <span class="n">path3</span><span class="p">,</span> <span class="n">path4</span><span class="p">,</span> <span class="n">path5</span><span class="p">],</span> <span class="n">group</span><span class="o">=</span><span class="n">mysum</span><span class="p">)</span>

<span class="c">## now, we can also simply sum paths 3,4,5...</span>
<span class="n">mysum</span><span class="o">.</span><span class="n">chi345</span> <span class="o">=</span> <span class="n">path3</span><span class="o">.</span><span class="n">chi</span> <span class="o">+</span> <span class="n">path4</span><span class="o">.</span><span class="n">chi</span> <span class="o">+</span> <span class="n">path5</span><span class="o">.</span><span class="n">chi</span>


<span class="n">newplot</span><span class="p">(</span><span class="n">mysum</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">mysum</span><span class="o">.</span><span class="n">chi</span><span class="o">*</span><span class="n">mysum</span><span class="o">.</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;sum(1,2,3,4,5)&#39;</span><span class="p">,</span> <span class="n">show_legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="s">r&#39; $ k \rm\, (\AA^{-1})$&#39;</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="s">r&#39;$ k^2\chi(k)$&#39;</span><span class="p">,</span>  <span class="n">title</span><span class="o">=</span><span class="n">mysum</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">path1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="o">+</span><span class="n">path1</span><span class="o">.</span><span class="n">chi</span><span class="o">*</span><span class="n">path1</span><span class="o">.</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;path1&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">path2</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">+</span><span class="n">path2</span><span class="o">.</span><span class="n">chi</span><span class="o">*</span><span class="n">path2</span><span class="o">.</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;path2&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">path3</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="o">+</span><span class="n">mysum</span><span class="o">.</span><span class="n">chi345</span><span class="o">*</span><span class="n">path3</span><span class="o">.</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;sum(3,4,5)&#39;</span><span class="p">)</span>

<span class="c">## end examples/feffit/doc_feffdat3.lar</span>
</pre></div>
</div>
<p>With the result as shown below.  Note that we can also make a simple sum of
a set of paths, which was done in this example to add the contributions of
paths 3, 4, and 5.  This works because <a class="reference internal" href="#_xafs.ff2chi" title="_xafs.ff2chi"><tt class="xref py py-func docutils literal"><span class="pre">ff2chi()</span></tt></a> runs <a class="reference internal" href="#_xafs.path2chi" title="_xafs.path2chi"><tt class="xref py py-func docutils literal"><span class="pre">path2chi()</span></tt></a>
for each path to be summed, so that the <tt class="docutils literal"><span class="pre">chi</span></tt> component of the FeffPath
group is up to date.</p>
<div class="figure align-center" id="xafs-fig14">
<a class="reference external image-reference" href="../_images/feffdat_example3.png"><img alt="../_images/feffdat_example3.png" src="../_images/feffdat_example3.png" style="width: 65%;" /></a>
<p class="caption"><strong>Figure 7.14:</strong> Results for sum of <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> for list of paths.</p>
</div>
</div>
<div class="section" id="example-using-path-parameters-when-adding-feff-files">
<h2>7.5.8. Example: Using Path Parameters when adding FEFF files<a class="headerlink" href="#example-using-path-parameters-when-adding-feff-files" title="Permalink to this headline">¶</a></h2>
<p>Using <a class="reference internal" href="../fitting/parameters.html#fitting-parameters-sec"><em>Parameters</em></a> for modelling data is a
key feature of Larch, and if you are modelling XAFS data with Feff, you
will want to parameterize Path Parameters, apply them to a set of Paths,
and investigate the resulting sum of Paths.    This is similar to the
examples above, but combines the Parameter concept from the Fitting
chapter.  In Larch, this looks like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## examples/feffit/doc_feffdat4.lar</span>

<span class="c"># read some paths</span>
<span class="n">path1</span> <span class="o">=</span> <span class="n">feffpath</span><span class="p">(</span><span class="s">&#39;feff_feo01.dat&#39;</span><span class="p">)</span>
<span class="n">path2</span> <span class="o">=</span> <span class="n">feffpath</span><span class="p">(</span><span class="s">&#39;feff_feo02.dat&#39;</span><span class="p">)</span>

<span class="c"># create a group containing parameters</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">del_e0</span>  <span class="o">=</span> <span class="n">param</span><span class="p">(</span><span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
             <span class="n">amp</span> <span class="o">=</span> <span class="n">param</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1.5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">e0</span>  <span class="o">=</span> <span class="s">&#39;del_e0&#39;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">s02</span> <span class="o">=</span> <span class="s">&#39;amp&#39;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">sigma2</span> <span class="o">=</span> <span class="mf">0.003</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="n">path2</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">sigma2</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">endfor</span>

<span class="n">mysum</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;FeO sum of paths&#39;</span><span class="p">)</span>

<span class="n">ff2chi</span><span class="p">([</span><span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">],</span> <span class="n">group</span><span class="o">=</span><span class="n">mysum</span><span class="p">,</span> <span class="n">paramgroup</span><span class="o">=</span><span class="n">pars</span><span class="p">)</span>

<span class="n">label</span><span class="o">=</span><span class="s">&#39;E0=</span><span class="si">%.1f</span><span class="s">, S02=</span><span class="si">%.1f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">del_e0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">amp</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">newplot</span><span class="p">(</span><span class="n">mysum</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">mysum</span><span class="o">.</span><span class="n">chi</span><span class="o">*</span><span class="n">mysum</span><span class="o">.</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">show_legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="s">r&#39;$ k \rm\, (\AA^{-1})$&#39;</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="s">r&#39;$ k^2\chi(k)$&#39;</span><span class="p">,</span>  <span class="n">title</span><span class="o">=</span><span class="n">mysum</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>

<span class="c"># now change parameter values, re-do sum</span>
<span class="n">pars</span><span class="o">.</span><span class="n">del_e0</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">3.5</span>
<span class="n">pars</span><span class="o">.</span><span class="n">amp</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c"># re-calculate chi for each path with paramgroup set</span>
<span class="c"># then sum the paths ourselves</span>

<span class="n">path2chi</span><span class="p">(</span><span class="n">path1</span><span class="p">,</span> <span class="n">paramgroup</span><span class="o">=</span><span class="n">pars</span><span class="p">)</span>
<span class="n">path2chi</span><span class="p">(</span><span class="n">path2</span><span class="p">,</span> <span class="n">paramgroup</span><span class="o">=</span><span class="n">pars</span><span class="p">)</span>

<span class="n">mysum</span><span class="o">.</span><span class="n">chi_alt</span> <span class="o">=</span> <span class="n">path1</span><span class="o">.</span><span class="n">chi</span> <span class="o">+</span> <span class="n">path2</span><span class="o">.</span><span class="n">chi</span>

<span class="n">label</span><span class="o">=</span><span class="s">&#39;E0=</span><span class="si">%.1f</span><span class="s">, S02=</span><span class="si">%.1f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">del_e0</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">pars</span><span class="o">.</span><span class="n">amp</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">mysum</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">mysum</span><span class="o">.</span><span class="n">chi_alt</span><span class="o">*</span><span class="n">mysum</span><span class="o">.</span><span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="c">## end examples/feffit/doc_feffdat4.lar</span>
</pre></div>
</div>
<p>After reading in the Feff data files, we have created a group <tt class="docutils literal"><span class="pre">pars</span></tt> of
Parameters with <a class="reference internal" href="../fitting/parameters.html#_math.param" title="_math.param"><tt class="xref py py-func docutils literal"><span class="pre">_math.param()</span></tt></a>, specifically <tt class="docutils literal"><span class="pre">pars.del_e0</span></tt> and
<tt class="docutils literal"><span class="pre">pars.amp</span></tt>.   Then we set the <tt class="docutils literal"><span class="pre">e0</span></tt> path parameter for each path to the
string <tt class="docutils literal"><span class="pre">'del_e0'</span></tt>, and the <tt class="docutils literal"><span class="pre">amp</span></tt> path parameter to <tt class="docutils literal"><span class="pre">'amp'</span></tt>.   We set
the <tt class="docutils literal"><span class="pre">sigma2</span></tt> values to simple numbers, as above.</p>
<p>Now, when running <a class="reference internal" href="#_xafs.ff2chi" title="_xafs.ff2chi"><tt class="xref py py-func docutils literal"><span class="pre">ff2chi()</span></tt></a>, we give not only a <tt class="docutils literal"><span class="pre">group</span></tt> to put the
results in, but also a <tt class="docutils literal"><span class="pre">paramgroup</span></tt> to use as the parameters for
evaluating any mathematical expressions we've defined for the path
parameters.   At this point, the strings <tt class="docutils literal"><span class="pre">del_e0</span></tt> and <tt class="docutils literal"><span class="pre">amp</span></tt> for the
path parameters for path 1 and 2 are converted into Parameters and
evaluated.</p>
<p id="index-5">After plotting the results, we then change the values of the parameters.
We could re-run <a class="reference internal" href="#_xafs.ff2chi" title="_xafs.ff2chi"><tt class="xref py py-func docutils literal"><span class="pre">ff2chi()</span></tt></a>, but we can also just run <a class="reference internal" href="#_xafs.path2chi" title="_xafs.path2chi"><tt class="xref py py-func docutils literal"><span class="pre">path2chi()</span></tt></a>
on the paths for which we want to recalculate <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/>.  Note that we
specify the <tt class="docutils literal"><span class="pre">paramgroup</span></tt> to <a class="reference internal" href="#_xafs.path2chi" title="_xafs.path2chi"><tt class="xref py py-func docutils literal"><span class="pre">path2chi()</span></tt></a> here.  Strictly speaking,
this is not necessary, as both <a class="reference internal" href="#_xafs.path2chi" title="_xafs.path2chi"><tt class="xref py py-func docutils literal"><span class="pre">path2chi()</span></tt></a> and <a class="reference internal" href="#_xafs.ff2chi" title="_xafs.ff2chi"><tt class="xref py py-func docutils literal"><span class="pre">ff2chi()</span></tt></a> set the
value of <tt class="docutils literal"><span class="pre">_sys.paramGroup</span></tt>, which is the default group used for looking
up names for expression in parameters.  That is, after the first call to
<a class="reference internal" href="#_xafs.ff2chi" title="_xafs.ff2chi"><tt class="xref py py-func docutils literal"><span class="pre">ff2chi()</span></tt></a>, <tt class="docutils literal"><span class="pre">sys.paramGroup</span></tt> is set to our parameter group <tt class="docutils literal"><span class="pre">pars</span></tt>
and any subsequent need to evaluate parameters will use that until
overridden by resetting <tt class="docutils literal"><span class="pre">_sys.paramGroup</span></tt>, which can be done by passing a
<tt class="docutils literal"><span class="pre">paramgroup</span></tt> argument to <a class="reference internal" href="#_xafs.path2chi" title="_xafs.path2chi"><tt class="xref py py-func docutils literal"><span class="pre">path2chi()</span></tt></a> or <a class="reference internal" href="#_xafs.ff2chi" title="_xafs.ff2chi"><tt class="xref py py-func docutils literal"><span class="pre">ff2chi()</span></tt></a>.</p>
<div class="figure align-center" id="xafs-fig15">
<a class="reference external image-reference" href="../_images/feffdat_example4.png"><img alt="../_images/feffdat_example4.png" src="../_images/feffdat_example4.png" style="width: 65%;" /></a>
<p class="caption"><strong>Figure 7.15:</strong> Results for making 2 different sums of paths using parameterized Path
Parameters</p>
</div>
<p>The resulting plot shows the effect of changing <img class="math" src="../_images/math/8a52f40afedf1c8727d71b0ad5a7ea0a7119b088.png" alt="E_0"/> and
<img class="math" src="../_images/math/fc923d7c827eca7b3f461463e11c982710c3bcb1.png" alt="S_0^2"/> for a sum of paths.  The same result could be shown by just
setting the path parameters to the appropriate numerical values, but the
use of parameters makes this somewhat more general.  As we will see in the
next section, the use of parameters also allows us to easily refine their
values in a fit of XAFS data to such a sum of paths.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="feffit.html" title="7.6. XAFS: Fitting XAFS to Feff Paths"
             >next</a> |</li>
        <li class="right" >
          <a href="xafsft.html" title="7.4. XAFS: Fourier Transforms for XAFS"
             >previous</a> |</li>
   <li><a href="../contents.html">contents</a>|&nbsp;</li>
   <li><a href="../downloads/index.html">downloads</a>|&nbsp;</li>
   <li><a href="../tutorial/index.html">tutorial</a>|&nbsp;</li>
   <li><a href="../data/index.html">data</a>|&nbsp;</li>
   <li><a href="../plotting/index.html">plot</a>|&nbsp;</li>
   <li><a href="../fitting/index.html">fit</a>|&nbsp;</li>
   <li><a href="index.html">XAFS</a>|&nbsp;</li>
   <li><a href="../xray/index.html">Xray Data</a>|&nbsp;</li>
   <li><a href="../xrf/index.html">XRF</a>|&nbsp;</li>

          <li><a href="index.html" >7. XAFS Analysis</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright Matthew Newville, The University of Chicago, 2012.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>