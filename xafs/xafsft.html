

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>XAFS: Fourier Transforms for XAFS &mdash; larch 0.9.14 documentation</title>
    
    <link rel="stylesheet" href="../_static/larchdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.14',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="larch 0.9.14 documentation" href="../index.html" />
    <link rel="up" title="XAFS Analysis with Larch" href="index.html" />
    <link rel="next" title="XAFS: Reading and using Feff Paths" href="feffpaths.html" />
    <link rel="prev" title="XAFS: Post-edge Background Subtraction" href="autobk.html" /> 
  </head>
  <body>
<div style=" color: #c5daba;  text-align: left;
            height:100px; padding: 0">
<table><tr>
  <td width=20% padding=0>
    <a href="#">
       <img src="../_static/larchcones.png" width=90% alt="larchcones"/>
    </a>
  </td><td width=80% padding=0>
      <font size=+3><a href="../index.html" style="color: #772211">
          Larch: X-ray Data Analysis   </a></font>
</td></tr></table>
</div>


    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="feffpaths.html" title="XAFS: Reading and using Feff Paths"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="autobk.html" title="XAFS: Post-edge Background Subtraction"
             accesskey="P">previous</a> |</li>
   <li><a href="../installation.html">download</a>|&nbsp;</li>
   <li><a href="../contents.html">contents</a>|&nbsp;</li>
   <li><a href="../tutorial/index.html">tutorial</a>|&nbsp;</li>
   <li><a href="../plotting/index.html">plot</a>|&nbsp;</li>
   <li><a href="../fitting/index.html">fit</a>|&nbsp;</li>
   <li><a href="index.html">XAFS</a>|&nbsp;</li>
   <li><a href="../xray/index.html">XRF</a>|&nbsp;</li>
   &nbsp;&nbsp;<li><a href="../search.html">search</a>|&nbsp;</li>

          <li><a href="index.html" accesskey="U">XAFS Analysis with Larch</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">XAFS: Fourier Transforms for XAFS</a><ul>
<li><a class="reference internal" href="#overview-of-xafs-fourier-transforms">Overview of XAFS Fourier transforms</a></li>
<li><a class="reference internal" href="#forward-xafs-fourier-transforms">Forward XAFS Fourier transforms (<img class="math" src="../_images/math/74a778df2be28afb0293f1bd3948fe7da53cf082.png" alt="k{\rightarrow}R"/>)</a></li>
<li><a class="reference internal" href="#reverse-xafs-fourier-transforms">Reverse XAFS Fourier transforms (<img class="math" src="../_images/math/355651533ada75aa6ca33a45d111bf5553d4301c.png" alt="R{\rightarrow}q"/>)</a></li>
<li><a class="reference internal" href="#ftwindow-generating-fourier-transform-windows"><tt class="docutils literal"><span class="pre">ftwindow()</span></tt>: Generating Fourier transform windows</a></li>
<li><a class="reference internal" href="#catalog-of-fourier-transform-window">Catalog of Fourier transform window</a></li>
<li><a class="reference internal" href="#examples-forward-xafs-fourier-transforms">Examples: Forward XAFS Fourier transforms</a></li>
<li><a class="reference internal" href="#examples-reverse-xafs-fourier-transforms-fourier-filtering">Examples: Reverse XAFS Fourier transforms, Fourier Filtering</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="autobk.html"
                        title="previous chapter">XAFS: Post-edge Background Subtraction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="feffpaths.html"
                        title="next chapter">XAFS: Reading and using Feff Paths</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/xafs/xafsft.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-_xafs">
<span id="xafs-fourier-transforms-for-xafs"></span><h1>XAFS: Fourier Transforms for XAFS<a class="headerlink" href="#module-_xafs" title="Permalink to this headline">¶</a></h1>
<p>Fourier transforms are central to understanding and using
XAFS. Consequently, many of the XAFS functions in Larch use XAFS Fourier
transforms as part of their processing, and many of the functions
parameters and arguments described here have names and meanings used
throughout the XAFS functionality of Larch.  For example, but
<a class="reference internal" href="autobk.html#_xafs.autobk" title="_xafs.autobk"><tt class="xref py py-func docutils literal"><span class="pre">autobk()</span></tt></a> and <a class="reference internal" href="feffit.html#_xafs.feffit" title="_xafs.feffit"><tt class="xref py py-func docutils literal"><span class="pre">feffit()</span></tt></a> rely on XAFS Fourier transforms, and use
the XAFS Fourier transform function described here.</p>
<div class="section" id="overview-of-xafs-fourier-transforms">
<h2>Overview of XAFS Fourier transforms<a class="headerlink" href="#overview-of-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>The standard Fourier transform of a signal <img class="math" src="../_images/math/1411b4cdb90fcfd2f55c9c77320893b4b4d6d911.png" alt="f(t)"/> can be written as</p>
<div class="math">
<p><img src="../_images/math/1cfed1a7439bb0126593f6fc3852b91ad3b4a7ff.png" alt="\begin{eqnarray*}
      {\tilde{f}}(\omega) &amp;=&amp; \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty}
    f(t) e^{-i{\omega}t} dt \\
    f(t) &amp;=&amp; \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty}
    {\tilde{f}}(\omega) e^{i{\omega}t} d{\omega} \\
\end{eqnarray*}"/></p>
</div><p>where the symmetric normalization is one of the more common choices of
conventions.  This gives conjugate variables of <img class="math" src="../_images/math/54d7d48553f4d9e7ab418118607ea324cbfddfda.png" alt="\omega"/> and
<img class="math" src="../_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>. Because XAFS goes as</p>
<div class="math">
<p><img src="../_images/math/30bac55e7dd9e447f4a9bd4b7b908dc6b713004b.png" alt="\chi(k) \sim \sin[2kR + \delta(k)]"/></p>
</div><p>the conjugate variables in XAFS are generally taken to be <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> and
<img class="math" src="../_images/math/0e86afd07eb8be7351058918c6ecae8e9d6eccb9.png" alt="2R"/>.  The normalization of <img class="math" src="../_images/math/addf6166115ffd93feb8be6dc7a575e5e6131611.png" alt="\tilde\chi(R)"/> from a Fourier
transform of <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> is a matter of convention, but we follow the
symmetric case above (with <img class="math" src="../_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/> replaced by <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> and
<img class="math" src="../_images/math/54d7d48553f4d9e7ab418118607ea324cbfddfda.png" alt="\omega"/> replaced by <img class="math" src="../_images/math/0e86afd07eb8be7351058918c6ecae8e9d6eccb9.png" alt="2R"/>, and of course <img class="math" src="../_images/math/bb2c93730dbb48558bb3c4738c956c4e8f816437.png" alt="f"/> by
<img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/>).</p>
<p>But there are two more important issues to mention.  First, an XAFS Fourier
transform multiplies <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> by a power of <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>, <img class="math" src="../_images/math/67c554dfde776faf84eee88fb710170179f1b5a4.png" alt="k^n"/>
and by a window function <img class="math" src="../_images/math/96353c36e52c43ad8175ee469239c4e6fcbe8230.png" alt="\Omega(k)"/> before doing the Fourier
transform.  The power-law weighting allow the oscillations in <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> to
emphasize different portions of the spectra, or to give a uniform intensity
to the oscillations.  The window function acts to smooth the resulting
Fourier transform and remove ripple and ringing in it that would result
from a sudden truncation of <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> at the end of the data range.</p>
<p>The second important issue is that the continuous Fourier transform
described above is replaced by a discrete transform.  This better matches
the discrete sampling of energy and <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> values of the data, and
allows Fast Fourier Transform techniques to be used.  It does change the
definitions of the transforms used somewhat. First, the <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/>
data must be on <em>uniformly spaced</em> set of <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> values.  The default
<img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> spacing used in Larch (including as output from <a class="reference internal" href="autobk.html#_xafs.autobk" title="_xafs.autobk"><tt class="xref py py-func docutils literal"><span class="pre">autobk()</span></tt></a>)
is <img class="math" src="../_images/math/e013ddc448485ecd4281810511cd2a986b06855e.png" alt="\delta k"/> = 0.05 <img class="math" src="../_images/math/2659c8fc56e332af1fdff0d17e5b6d0078003d17.png" alt="\rm\AA^{-1}"/>.  Second, the array size for
<img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> used in the Fourier transform should be a power of 2. The
default used in Larch is <img class="math" src="../_images/math/182d1a26e1047e88dbb946be3bebe76d50f01a60.png" alt="N_{\rm fft}"/> = 2048.   Together, these
allow <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> data to 102.4 <img class="math" src="../_images/math/2659c8fc56e332af1fdff0d17e5b6d0078003d17.png" alt="\rm\AA^{-1}"/>.  Of course, real
data doesn&#8217;t extend that far, so the array to be transformed is
<em>zero-padded</em> to the end of the range.  Since the spacing <img class="math" src="../_images/math/54a4250f367ce0b8542a9368e68ef0d4a575db8c.png" alt="\delta R"/>
of the resulting discrete <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> is given as
<img class="math" src="../_images/math/6aaa36141c92d3e6925d150ed77e7f22599b017e.png" alt="\pi/{(N_{\rm fft} \delta k )}"/>, the extended range and zero-padding
will increase the density of points in <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/>, smoothly
interpolating the values.   For <img class="math" src="../_images/math/182d1a26e1047e88dbb946be3bebe76d50f01a60.png" alt="N_{\rm fft}"/> = 2048 and
<img class="math" src="../_images/math/e013ddc448485ecd4281810511cd2a986b06855e.png" alt="\delta k"/> =  0.05 <img class="math" src="../_images/math/2659c8fc56e332af1fdff0d17e5b6d0078003d17.png" alt="\rm\AA^{-1}"/>, the <img class="math" src="../_images/math/eff43e84f8a3bcf7b6965f0a3248bc4d3a9d0cd4.png" alt="R"/> spacing is
approximately <img class="math" src="../_images/math/54a4250f367ce0b8542a9368e68ef0d4a575db8c.png" alt="\delta R"/> =  0.0307 <img class="math" src="../_images/math/4b6bdf76ce578daae9153facd099f9665714830d.png" alt="\rm\AA"/>.</p>
<p>For the discrete Fourier transforms with samples of <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> at the
points <img class="math" src="../_images/math/875d70b055ab564f18ddfd7908dc2b5c49b5a56e.png" alt="k_n = n \, \delta k"/>, and samples of <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> at the
points <img class="math" src="../_images/math/9052cb2d0874b94841e2ea531f1220373074ebfb.png" alt="R_m = m \, \delta R"/>, the definitions become:</p>
<div class="math">
<p><img src="../_images/math/dcdae00c08825e44c992fc26fb762b726f9edaaa.png" alt="\begin{eqnarray*}
\tilde\chi(R_m) &amp;=&amp; \frac{i \delta k}{\sqrt{\pi N_{\rm fft}}} \,
                    \sum_{n=1}^{N_{\rm fft}} \chi(k_n) \,
                    \Omega(k_n) \, k_n^w e^{2i\pi n m/N_{\rm fft}} \\
\tilde\chi(k_n) &amp;=&amp; \frac{2 i \delta R}{\sqrt{\pi N_{\rm fft}}} \,
                    \sum_{m=1}^{N_{\rm fft}} \tilde\chi(R_m) \,
                    \Omega(R_m) \, e^{-2i\pi n m/N_{\rm fft}} \\
\end{eqnarray*}"/></p>
</div><p>These normalizations preserve the symmetry properties of the Fourier
Transforms with conjugate variables <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> and <img class="math" src="../_images/math/0e86afd07eb8be7351058918c6ecae8e9d6eccb9.png" alt="2R"/>.
Though the reverse transform converts the complex <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> to the
complex <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> on the same <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> spacing as the starting
data, we often refer to the filtered <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> as <em>q</em> space.</p>
<p>A final complication in using Fourier transforms for XAFS is that the
measured <img class="math" src="../_images/math/adda5391fa04cf4b9e1bdc9b8bf51ddd5bec6977.png" alt="\mu(E)"/> and <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> are a strictly real values,
while the Fourier transform inherently treats <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> and
<img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> as complex values. This leads to an ambiguity about how to
construct the complex <img class="math" src="../_images/math/75d0c399209160e54647ed1a585b4a3fd6c50db0.png" alt="\tilde\chi(k)"/>.  In many formal treatments,
XAFS is written as the imaginary part of a complex function.  This might
lead one to assume that constructing <img class="math" src="../_images/math/75d0c399209160e54647ed1a585b4a3fd6c50db0.png" alt="\tilde\chi(k)"/> as <img class="math" src="../_images/math/f06449aa2e275ef24092dc27b917a9699a774d69.png" alt="0 +
i\chi(k)"/> would be the natural choice.  For historical reasons, Larch uses
the opposite convention, constructing <img class="math" src="../_images/math/75d0c399209160e54647ed1a585b4a3fd6c50db0.png" alt="\tilde\chi(k)"/> as
<img class="math" src="../_images/math/e2e79cd3f834c12d0f4b981ab5d9ad42dc051cd9.png" alt="\chi(k) + 0i"/>.   As we&#8217;ll see below, you can easily change this
convention.  The effect of this choice is minor unless one is
concerned about the differences of the real and imaginary parts of
<img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> or one is intending to filter and back-transform the
<img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> and compare the filtered and unfiltered data.</p>
</div>
<div class="section" id="forward-xafs-fourier-transforms">
<h2>Forward XAFS Fourier transforms (<img class="math" src="../_images/math/74a778df2be28afb0293f1bd3948fe7da53cf082.png" alt="k{\rightarrow}R"/>)<a class="headerlink" href="#forward-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>The forward Fourier transform converts <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> to <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/>
and is of primary importance for XAFS analysis.  In Larch, this is
encapsulated in the <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><tt class="xref py py-func docutils literal"><span class="pre">xftf()</span></tt></a> function.</p>
<dl class="function">
<dt id="_xafs.xftf">
<tt class="descclassname">_xafs.</tt><tt class="descname">xftf</tt><big>(</big><em>k</em>, <em>chi</em>, <em>group=None</em>, <em>...</em><big>)</big><a class="headerlink" href="#_xafs.xftf" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a forward XAFS Fourier transform, from <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> to
<img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/>, using common XAFS conventions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> &#8211; 1-d array of photo-electron wavenumber in <img class="math" src="../_images/math/2659c8fc56e332af1fdff0d17e5b6d0078003d17.png" alt="\rm\AA^{-1}"/></li>
<li><strong>chi</strong> &#8211; 1-d array of <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/></li>
<li><strong>group</strong> &#8211; output Group</li>
<li><strong>rmax_out</strong> &#8211; highest <em>R</em> for output data (10 <img class="math" src="../_images/math/4b6bdf76ce578daae9153facd099f9665714830d.png" alt="\rm\AA"/>)</li>
<li><strong>kweight</strong> &#8211; exponent for weighting spectra by <img class="math" src="../_images/math/351cfe295a9c1727c0af7a2d3e2cb31984cd439b.png" alt="k^{\rm kweight}"/></li>
<li><strong>kmin</strong> &#8211; starting <em>k</em> for FT Window</li>
<li><strong>kmax</strong> &#8211; ending <em>k</em> for FT Window</li>
<li><strong>dk</strong> &#8211; tapering parameter for FT Window</li>
<li><strong>dk2</strong> &#8211; second tapering parameter for FT Window</li>
<li><strong>window</strong> &#8211; name of window type</li>
<li><strong>nfft</strong> &#8211; value to use for <img class="math" src="../_images/math/182d1a26e1047e88dbb946be3bebe76d50f01a60.png" alt="N_{\rm fft}"/> (2048).</li>
<li><strong>kstep</strong> &#8211; value to use for <img class="math" src="../_images/math/fbdfd51d57bb2c9ba22c27cbd408d65200d28f70.png" alt="\delta{k}"/> (0.05).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">None</span></tt> &#8211; outputs are written to supplied group.</p>
</td>
</tr>
</tbody>
</table>
<p>If a <tt class="docutils literal"><span class="pre">group</span></tt> argument is provided, the following data arrays are put into it:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>kwin</td>
<td>window <img class="math" src="../_images/math/96353c36e52c43ad8175ee469239c4e6fcbe8230.png" alt="\Omega(k)"/> (length of input chi(k)).</td>
</tr>
<tr class="row-odd"><td>r</td>
<td>uniform array of <img class="math" src="../_images/math/eff43e84f8a3bcf7b6965f0a3248bc4d3a9d0cd4.png" alt="R"/>, out to <tt class="docutils literal"><span class="pre">rmax_out</span></tt>.</td>
</tr>
<tr class="row-even"><td>chir</td>
<td>complex array of <img class="math" src="../_images/math/addf6166115ffd93feb8be6dc7a575e5e6131611.png" alt="\tilde\chi(R)"/>.</td>
</tr>
<tr class="row-odd"><td>chir_mag</td>
<td>magnitude of <img class="math" src="../_images/math/addf6166115ffd93feb8be6dc7a575e5e6131611.png" alt="\tilde\chi(R)"/>.</td>
</tr>
<tr class="row-even"><td>chir_pha</td>
<td>phase of <img class="math" src="../_images/math/addf6166115ffd93feb8be6dc7a575e5e6131611.png" alt="\tilde\chi(R)"/>.</td>
</tr>
<tr class="row-odd"><td>chir_re</td>
<td>real part of of <img class="math" src="../_images/math/addf6166115ffd93feb8be6dc7a575e5e6131611.png" alt="\tilde\chi(R)"/>.</td>
</tr>
<tr class="row-even"><td>chir_im</td>
<td>imaginary part of <img class="math" src="../_images/math/addf6166115ffd93feb8be6dc7a575e5e6131611.png" alt="\tilde\chi(R)"/>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>It is expected that the input <tt class="docutils literal"><span class="pre">k</span></tt> be a uniformly spaced array of
values with spacing <tt class="docutils literal"><span class="pre">kstep</span></tt>, starting a 0.  If it is not, the <tt class="docutils literal"><span class="pre">k</span></tt>
and <tt class="docutils literal"><span class="pre">chi</span></tt> data will be linearly interpolated onto the proper grid.</p>
<p>The FT window parameters are explained in more detail in the discussion of
<a class="reference internal" href="#_xafs.ftwindow" title="_xafs.ftwindow"><tt class="xref py py-func docutils literal"><span class="pre">ftwindow()</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="_xafs.xftf_fast">
<tt class="descclassname">_xafs.</tt><tt class="descname">xftf_fast</tt><big>(</big><em>chi</em>, <em>nfft=2048</em>, <em>kstep=0.05</em><big>)</big><a class="headerlink" href="#_xafs.xftf_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a forward XAFS Fourier transform, from <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> to
<img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/>, using common XAFS conventions.  This version demands
<tt class="docutils literal"><span class="pre">chi</span></tt> to include any weighting and windowing, and so to represent
<img class="math" src="../_images/math/5033522b081001dc55c49c3543b97c7965e65710.png" alt="\chi(k)k^w\Omega(k)"/> on a uniform <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> grid. It returns
the complex array of <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chi</strong> &#8211; 1-d array of <img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/> to be transformed</li>
<li><strong>nfft</strong> &#8211; value to use for <img class="math" src="../_images/math/182d1a26e1047e88dbb946be3bebe76d50f01a60.png" alt="N_{\rm fft}"/> (2048).</li>
<li><strong>kstep</strong> &#8211; value to use for <img class="math" src="../_images/math/fbdfd51d57bb2c9ba22c27cbd408d65200d28f70.png" alt="\delta{k}"/> (0.05).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">complex <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="reverse-xafs-fourier-transforms">
<h2>Reverse XAFS Fourier transforms (<img class="math" src="../_images/math/355651533ada75aa6ca33a45d111bf5553d4301c.png" alt="R{\rightarrow}q"/>)<a class="headerlink" href="#reverse-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>Reverse Fourier transforms convert <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> back to filtered
<img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/>.  We refer to the filtered <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> space as <img class="math" src="../_images/math/0615acc3725de21025457e7d6f7694dab8e2f758.png" alt="q"/> to
emphasize the distinction between the two.  The filtered <img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/> is
complex.  By convention, the real part of <img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/> corresponds to
the explicitly real <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/>.</p>
<dl class="function">
<dt id="_xafs.xftr">
<tt class="descclassname">_xafs.</tt><tt class="descname">xftr</tt><big>(</big><em>r</em>, <em>chir</em>, <em>group=None</em>, <em>...</em><big>)</big><a class="headerlink" href="#_xafs.xftr" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a reverse XAFS Fourier transform, from <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> to
<img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> &#8211; 1-d array of distance.</li>
<li><strong>chir</strong> &#8211; 1-d array of <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/></li>
<li><strong>group</strong> &#8211; output Group</li>
<li><strong>qmax_out</strong> &#8211; highest <em>k</em> for output data (30 <img class="math" src="../_images/math/2659c8fc56e332af1fdff0d17e5b6d0078003d17.png" alt="\rm\AA^{-1}"/>)</li>
<li><strong>rweight</strong> &#8211; exponent for weighting spectra by <img class="math" src="../_images/math/7f7dde7e8077bca2262381d70233bdc21c0c05f7.png" alt="r^{\rm rweight}"/> (0)</li>
<li><strong>rmin</strong> &#8211; starting <em>R</em> for FT Window</li>
<li><strong>rmax</strong> &#8211; ending <em>R</em> for FT Window</li>
<li><strong>dr</strong> &#8211; tapering parameter for FT Window</li>
<li><strong>dr2</strong> &#8211; second tapering parameter for FT Window</li>
<li><strong>window</strong> &#8211; name of window type</li>
<li><strong>nfft</strong> &#8211; value to use for <img class="math" src="../_images/math/182d1a26e1047e88dbb946be3bebe76d50f01a60.png" alt="N_{\rm fft}"/> (2048).</li>
<li><strong>kstep</strong> &#8211; value to use for <img class="math" src="../_images/math/fbdfd51d57bb2c9ba22c27cbd408d65200d28f70.png" alt="\delta{k}"/> (0.05).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">None</span></tt> &#8211; outputs are written to supplied group.</p>
</td>
</tr>
</tbody>
</table>
<p>If a <tt class="docutils literal"><span class="pre">group</span></tt> argument is provided, the following data arrays are put into it:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>rwin</td>
<td>window <img class="math" src="../_images/math/3c29d523162251a32c706183e9c88a1d744cee65.png" alt="\Omega(R)"/> (length of input chi(R)).</td>
</tr>
<tr class="row-odd"><td>q</td>
<td>uniform array of <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>, out to <tt class="docutils literal"><span class="pre">qmax_out</span></tt>.</td>
</tr>
<tr class="row-even"><td>chiq</td>
<td>complex array of <img class="math" src="../_images/math/75d0c399209160e54647ed1a585b4a3fd6c50db0.png" alt="\tilde\chi(k)"/>.</td>
</tr>
<tr class="row-odd"><td>chiq_mag</td>
<td>magnitude of <img class="math" src="../_images/math/75d0c399209160e54647ed1a585b4a3fd6c50db0.png" alt="\tilde\chi(k)"/>.</td>
</tr>
<tr class="row-even"><td>chiq_pha</td>
<td>phase of <img class="math" src="../_images/math/75d0c399209160e54647ed1a585b4a3fd6c50db0.png" alt="\tilde\chi(k)"/>.</td>
</tr>
<tr class="row-odd"><td>chiq_re</td>
<td>real part of of <img class="math" src="../_images/math/75d0c399209160e54647ed1a585b4a3fd6c50db0.png" alt="\tilde\chi(k)"/>.</td>
</tr>
<tr class="row-even"><td>chiq_im</td>
<td>imaginary part of <img class="math" src="../_images/math/75d0c399209160e54647ed1a585b4a3fd6c50db0.png" alt="\tilde\chi(k)"/>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>In analogy with <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><tt class="xref py py-func docutils literal"><span class="pre">xftf()</span></tt></a>, it is expected that the input <tt class="docutils literal"><span class="pre">r</span></tt> be a
uniformly spaced array of values starting a 0.</p>
<p>The input <tt class="docutils literal"><span class="pre">chir</span></tt> array can be either the complex <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> array
as output to <tt class="docutils literal"><span class="pre">Group.chir</span></tt> from <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><tt class="xref py py-func docutils literal"><span class="pre">xftf()</span></tt></a>, or one of the real or
imaginary parts of the <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> as output to <tt class="docutils literal"><span class="pre">Group.chir_re</span></tt> or
<tt class="docutils literal"><span class="pre">Group.chir_im</span></tt>.</p>
<p>The FT window parameters are explained in more detail in the discussion of
<a class="reference internal" href="#_xafs.ftwindow" title="_xafs.ftwindow"><tt class="xref py py-func docutils literal"><span class="pre">ftwindow()</span></tt></a>.</p>
</dd></dl>

<dl class="function">
<dt id="_xafs.xftr_fast">
<tt class="descclassname">_xafs.</tt><tt class="descname">xftr_fast</tt><big>(</big><em>chir</em>, <em>nfft=2048</em>, <em>kstep=0.05</em><big>)</big><a class="headerlink" href="#_xafs.xftr_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a reverse XAFS Fourier transform, from <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> to
<img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/>, using common XAFS conventions.  This version demands
<tt class="docutils literal"><span class="pre">chir</span></tt> be  the complex <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> as created from <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><tt class="xref py py-func docutils literal"><span class="pre">xftf()</span></tt></a>.
It returns the complex array of <img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/> without putting any
values into a group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chir</strong> &#8211; 1-d array of <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> to be transformed</li>
<li><strong>nfft</strong> &#8211; value to use for <img class="math" src="../_images/math/182d1a26e1047e88dbb946be3bebe76d50f01a60.png" alt="N_{\rm fft}"/> (2048).</li>
<li><strong>kstep</strong> &#8211; value to use for <img class="math" src="../_images/math/fbdfd51d57bb2c9ba22c27cbd408d65200d28f70.png" alt="\delta{k}"/> (0.05).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">complex <img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ftwindow-generating-fourier-transform-windows">
<h2><a class="reference internal" href="#_xafs.ftwindow" title="_xafs.ftwindow"><tt class="xref py py-func docutils literal"><span class="pre">ftwindow()</span></tt></a>: Generating Fourier transform windows<a class="headerlink" href="#ftwindow-generating-fourier-transform-windows" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above, a Fourier transform window will smooth the resulting
Fourier transformed spectrum, removing ripple and ringing in it that would
result from a sudden truncation data at the end of it range.  There is an
extensive literature on such windows, and a lot of choices and parameters
available for constructing windows.  A sampling of windows is shown below.</p>
<dl class="function">
<dt id="_xafs.ftwindow">
<tt class="descclassname">_xafs.</tt><tt class="descname">ftwindow</tt><big>(</big><em>x</em>, <em>xmin=0</em>, <em>xmax=None</em>, <em>dk=1</em>, <em>...</em><big>)</big><a class="headerlink" href="#_xafs.ftwindow" title="Permalink to this definition">¶</a></dt>
<dd><p>create a Fourier transform window array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> &#8211; 1-d array array to build window on.</li>
<li><strong>xmin</strong> &#8211; starting <em>x</em> for FT Window</li>
<li><strong>xmax</strong> &#8211; ending <em>x</em> for FT Window</li>
<li><strong>dx</strong> &#8211; tapering parameter for FT Window</li>
<li><strong>dx2</strong> &#8211; second tapering parameter for FT Window (=dx)</li>
<li><strong>window</strong> &#8211; name of window type</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">1-d window array.</p>
</td>
</tr>
</tbody>
</table>
<p>Note that if <tt class="docutils literal"><span class="pre">dx</span></tt> is specified but <tt class="docutils literal"><span class="pre">dx2</span></tt> is not, <tt class="docutils literal"><span class="pre">dx2</span></tt> will
generally take the same value as <tt class="docutils literal"><span class="pre">dx</span></tt>.</p>
<p>The window type must be one of those listed in the <a class="reference internal" href="#xafs-ftwin-table"><em>Table of
Fourier Transform Window Types</em></a>.</p>
</dd></dl>

<blockquote id="xafs-ftwin-table">
<span id="index-0"></span><div><p>Table of Fourier Transform Window Types</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">window name</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>hanning</td>
<td>cosine-squared taper</td>
</tr>
<tr class="row-odd"><td>parzen</td>
<td>linear taper</td>
</tr>
<tr class="row-even"><td>welch</td>
<td>quadratic taper</td>
</tr>
<tr class="row-odd"><td>gaussian</td>
<td>Gaussian (normal) function window</td>
</tr>
<tr class="row-even"><td>sine</td>
<td>sine function window</td>
</tr>
<tr class="row-odd"><td>kaiser</td>
<td>Kaiser-Bessel function-derived window</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>In general, the window arrays have a value that gradually increases from 0
up to 1 at the low-k end, may stay with a value 1 over some central
portion, and then tapers down to 0 at the high-k end.  The meaning of the
<tt class="docutils literal"><span class="pre">dx</span></tt> and <tt class="docutils literal"><span class="pre">dx2</span></tt>, and even <tt class="docutils literal"><span class="pre">xmin</span></tt>, and <tt class="docutils literal"><span class="pre">xmax</span></tt> varies a bit for the
different window types.  The Hanning, Parzen, and Welch windows share a
convention that the windows taper up from 0 to 1 between <tt class="docutils literal"><span class="pre">xmin-dx/2</span></tt> and
<tt class="docutils literal"><span class="pre">xmin+dx/2</span></tt>, and then taper down from 1 to 0 between <tt class="docutils literal"><span class="pre">xmax-dx2/2</span></tt> and
<tt class="docutils literal"><span class="pre">xmax+dx2/2</span></tt>.</p>
<p>The conventions for the Kaiser, Gaussian, and Sine window types is a bit
more complicated, and is best given explicitly.  In the formulas below,
<tt class="docutils literal"><span class="pre">dx</span></tt> written as <img class="math" src="../_images/math/953640113c8002037caa26af92570f9cb7d5773c.png" alt="dx"/> and <tt class="docutils literal"><span class="pre">dx2</span></tt> as <img class="math" src="../_images/math/ef7ae99d9c96a8db0e0ed595415b0698139f3093.png" alt="dx_2"/>.  We
define <img class="math" src="../_images/math/78eee4650adaefc6dafa348b4daa6ac74364b6c2.png" alt="x_i = x_{\rm min} - dx/2"/>, <img class="math" src="../_images/math/51b03691de8732b1d38ac8d02f4535c067f292f1.png" alt="x_f = x_{\rm max} +
dx_2/2"/>, and <img class="math" src="../_images/math/508cee5c6e8f4034e022e4a4cfe90a8294a459d1.png" alt="x_0 = (x_f + x_i)/2"/>, as the beginning, end, and
center of the widows.  For the Gaussian window, the form is:</p>
<div class="math">
<p><img src="../_images/math/8996c67b6d5e0fbd0cbdaa36d75826115becaee5.png" alt="\Omega(x) = \exp{\bigl[ -\frac{(x - x_0)^2}{2{dx}^2}\bigr]}"/></p>
</div><p>The form for the Sine window is</p>
<div class="math">
<p><img src="../_images/math/8a459578a28dd26cc842a2f8d18eefc3ae64192e.png" alt="\Omega(x) = \sin{\bigl[ \frac{ \pi(x_f - x)}{x_f - x_i}\bigr]}"/></p>
</div><p>between <img class="math" src="../_images/math/67bc6daa9d6b964201d6cef60cbeb1ac5fd26ead.png" alt="x_i"/>  and  <img class="math" src="../_images/math/67ada7f9d2a055fd6b1a64ebe5e53a566410af37.png" alt="x_f"/>, and 0 outside this range.
The Kaiser-Bessel window is slightly more complicated:</p>
<div class="math">
<p><img src="../_images/math/585fa421c595e2d4c9242eebfe5d0fcd007c3995.png" alt="\begin{eqnarray*}
   a       &amp;=&amp; \sqrt{\max{\bigl[0, 1 - \frac{4(x-x_0)^2}{(x_f-x_i)^2} \bigr] }} \\
  \Omega(x) &amp;=&amp; \frac{i_0(a dx) - 1}{i_0(dx) - 1} \\
\end{eqnarray*}"/></p>
</div><p>where <img class="math" src="../_images/math/1b5590d608ffe24233396eb2e4f8ca142ae42963.png" alt="i_0"/> is the modified Bessel function of order 0.</p>
</div>
<div class="section" id="catalog-of-fourier-transform-window">
<h2>Catalog of Fourier transform window<a class="headerlink" href="#catalog-of-fourier-transform-window" title="Permalink to this headline">¶</a></h2>
<p>Here, we give a series of example windows, to illustrate the different
window types and the effect of the various parameters.  The meanings of
<tt class="docutils literal"><span class="pre">xmin</span></tt>, <tt class="docutils literal"><span class="pre">xmax</span></tt>, <tt class="docutils literal"><span class="pre">dx</span></tt> and <tt class="docutils literal"><span class="pre">dx2</span></tt> are identical for the Hanning, Parzen and
Welch windows, and illustrated in the two following figures.</p>
<blockquote id="xafs-fig5">
<div><blockquote>
<div>Figure 5. Fourier Transform window examples and illustration of
parameter meaning for the Hanning, Parzen, and Welch windows.  Note that
<img class="math" src="../_images/math/2ae1ad42e768145863b64ec04691fd7ba83f3c31.png" alt="\Omega(x=x_{\rm min}) = \Omega(x=x_{\rm max}) = 0.5"/>, and that
the meaning of <tt class="docutils literal"><span class="pre">dx</span></tt> is to control the taper over which the window
changes from 0 to 1.  Here, <tt class="docutils literal"><span class="pre">xmin=5</span></tt> and <tt class="docutils literal"><span class="pre">xmax=15</span></tt>.</div></blockquote>
<a class="reference external image-reference" href="../_images/ftwin_example1.png"><img alt="../_images/ftwin_example1.png" src="../_images/ftwin_example1.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="../_images/ftwin_example2.png"><img alt="../_images/ftwin_example2.png" src="../_images/ftwin_example2.png" style="width: 48%;" /></a>
</div></blockquote>
<blockquote id="xafs-fig6">
<div><blockquote>
<div>Figure 6. Fourier Transform window examples and illustration of
parameter meaning.  On the left, a comparison of Welch, Parzen, and
Hanning with the same parameters is shown.  On the right, the effect of
<tt class="docutils literal"><span class="pre">dx2</span></tt> is shown as a different amount of taper on the high- and
low-<tt class="docutils literal"><span class="pre">x</span></tt> end of the window.  As before, <tt class="docutils literal"><span class="pre">xmin=5</span></tt> and <tt class="docutils literal"><span class="pre">xmax=15</span></tt>.</div></blockquote>
<a class="reference external image-reference" href="../_images/ftwin_example3.png"><img alt="../_images/ftwin_example3.png" src="../_images/ftwin_example3.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="../_images/ftwin_example4.png"><img alt="../_images/ftwin_example4.png" src="../_images/ftwin_example4.png" style="width: 48%;" /></a>
</div></blockquote>
<p>The Gaussian, Sine, and Kaiser-Bessel windows are illustrated next. These
go to 1 at the average of <tt class="docutils literal"><span class="pre">xmin</span></tt> and <tt class="docutils literal"><span class="pre">xmax</span></tt>, but do not stay at 1 over
a central portion of the window &#8211; they taper continuously.  The Gaussian
window is a simple Gaussian function, and is not truncated according to
<tt class="docutils literal"><span class="pre">xmin</span></tt> and <tt class="docutils literal"><span class="pre">xmax</span></tt>, and the <tt class="docutils literal"><span class="pre">dx</span></tt> parameter sets the width.  The Sine
and Kaiser-Bessel windows both go to zero at  <tt class="docutils literal"><span class="pre">xmin-dx/2</span></tt> and <tt class="docutils literal"><span class="pre">xmax</span> <span class="pre">+</span>
<span class="pre">dx/2</span></tt>.  For very large values of <tt class="docutils literal"><span class="pre">dx</span></tt>, the Kaiser-Bessel window
approaches a nearly Gaussian lineshape.</p>
<blockquote id="xafs-fig7">
<div><blockquote>
<div>Figure 7. Fourier Transform windows. On the left, a comparison of Kaiser-Bessel,
Sine, and Gaussian windows with the same parameters is shown.  On the right, the effect of
<tt class="docutils literal"><span class="pre">dx</span></tt> is shown for the Kaiser-Bessel window, and a closer comparison to a
Gaussian window is made.</div></blockquote>
<a class="reference external image-reference" href="../_images/ftwin_example5.png"><img alt="../_images/ftwin_example5.png" src="../_images/ftwin_example5.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="../_images/ftwin_example6.png"><img alt="../_images/ftwin_example6.png" src="../_images/ftwin_example6.png" style="width: 48%;" /></a>
</div></blockquote>
</div>
<div class="section" id="examples-forward-xafs-fourier-transforms">
<h2>Examples: Forward XAFS Fourier transforms<a class="headerlink" href="#examples-forward-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>Now we show some example Fourier transforms, illustrating the real and
imaginary parts of the <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> as well as the magnitude, the effect
of different windows types, and Fourier filtering to <img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/>.  We
use a single XAFS dataset from FeO for all these examples, with a
well-separated first and second shell.  The full scripts to generate the
figures shown here are included in the <em>examples/xafs/</em> folder.</p>
<p>We start with a comparison of a small value of <tt class="docutils literal"><span class="pre">dk</span></tt> and a larger value.
A script that runs <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><tt class="xref py py-func docutils literal"><span class="pre">xftf()</span></tt></a>, changing on <tt class="docutils literal"><span class="pre">dk</span></tt> would look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xftf</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s">&#39;hanning&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat1</span><span class="p">)</span>

<span class="n">dat2</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c"># make a copy of the group</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat2</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat2</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s">&#39;hanning&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat2</span><span class="p">)</span>
</pre></div>
</div>
<p>would result in the following results:</p>
<blockquote id="xafs-fig8">
<div><a class="reference external image-reference" href="../_images/xft_example1.png"><img alt="../_images/xft_example1.png" src="../_images/xft_example1.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="../_images/xft_example2.png"><img alt="../_images/xft_example2.png" src="../_images/xft_example2.png" style="width: 48%;" /></a>
<p>Figure 8.  Comparison of the effect of different values of <tt class="docutils literal"><span class="pre">dk</span></tt> on real
XAFS Fourier transforms.  Increasing <tt class="docutils literal"><span class="pre">dk</span></tt> reduces peak heights and
tends to broaden peaks, but the effects are rather small.</p>
</div></blockquote>
<p>A script that runs <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><tt class="xref py py-func docutils literal"><span class="pre">xftf()</span></tt></a> with consistent parameters, but different
window types:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xftf</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s">&#39;hanning&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat1</span><span class="p">)</span>

<span class="n">dat2</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c"># make a copy of the group</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat2</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat2</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s">&#39;parzen&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat2</span><span class="p">)</span>

<span class="n">dat3</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c">#</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat3</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat3</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s">&#39;welch&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat3</span><span class="p">)</span>

<span class="n">dat4</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c">#</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat4</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat4</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s">&#39;kaiser&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat4</span><span class="p">)</span>

<span class="n">dat5</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c">#</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat5</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat5</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s">&#39;gaussian&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat5</span><span class="p">)</span>
</pre></div>
</div>
<p>would result in the following results:</p>
<blockquote id="xafs-fig9">
<div><a class="reference external image-reference" href="../_images/xft_example3.png"><img alt="../_images/xft_example3.png" src="../_images/xft_example3.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="../_images/xft_example4.png"><img alt="../_images/xft_example4.png" src="../_images/xft_example4.png" style="width: 48%;" /></a>
<p>Figure 9.  Comparison of the effect of different window types
on real XAFS Fourier transforms.</p>
</div></blockquote>
<p>We now turn our attention to the different components of the Fourier
transform.  As above, it is most common to plot the magnitude of the
Fourier transform.  But, as the transformed <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> is complex, it
can be instructive to plot the real and imaginary components, as shown
below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">newplot</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chir_mag</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;chir_mag&#39;</span><span class="p">,</span>
        <span class="n">show_legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s">&#39;ur&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="s">r&#39;$R \rm\, (\AA)$&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s">r&#39;$\chi(R)\rm\,(\AA^{-3})$&#39;</span> <span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chir_re</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;chir_re&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chir_im</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;chir_im&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>which results in</p>
<blockquote id="xafs-fig10">
<div><a class="reference external image-reference" href="../_images/xft_example5.png"><img alt="../_images/xft_example5.png" src="../_images/xft_example5.png" style="width: 65%;" /></a>
<p>Figure 10. The real and imaginary components of the XAFS Fourier
transform.</p>
</div></blockquote>
<p>In fact, in the analysis discussed with <a class="reference internal" href="feffit.html#_xafs.feffit" title="_xafs.feffit"><tt class="xref py py-func docutils literal"><span class="pre">feffit()</span></tt></a>, the real and
imaginary components are used, not simply the magnitude.</p>
</div>
<div class="section" id="examples-reverse-xafs-fourier-transforms-fourier-filtering">
<h2>Examples: Reverse XAFS Fourier transforms, Fourier Filtering<a class="headerlink" href="#examples-reverse-xafs-fourier-transforms-fourier-filtering" title="Permalink to this headline">¶</a></h2>
<p>A reverse Fourier transform will convert data from <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> to
<img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/>.  This allows a limited range of frequencies (distances) to
be isolated and turned back into a <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> spectrum.  Here, we show
two different <img class="math" src="../_images/math/eff43e84f8a3bcf7b6965f0a3248bc4d3a9d0cd4.png" alt="R"/> windows to filter either just the first shell of
the spectra, or the first two shells, and compare the resulting filtered
<img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/>.</p>
<blockquote id="xafs-fig11">
<div><a class="reference external image-reference" href="../_images/xft_example6.png"><img alt="../_images/xft_example6.png" src="../_images/xft_example6.png" style="width: 48%;" /></a>
<a class="reference external image-reference" href="../_images/xft_example7.png"><img alt="../_images/xft_example7.png" src="../_images/xft_example7.png" style="width: 48%;" /></a>
<p>Figure 11.  Reverse XAFS Fourier transform, or Fourier filtering.  Here,
one can see the effect of different window sizes on the Fourier filtered
spectrum.  Including the first two peaks or shells reproduces most of the
original spectrum, with only high-frequency components removed.</p>
</div></blockquote>
<p>Note that it is <tt class="docutils literal"><span class="pre">chiq_re</span></tt> that is compared to the k-weighted <tt class="docutils literal"><span class="pre">chi</span></tt>
array.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="feffpaths.html" title="XAFS: Reading and using Feff Paths"
             >next</a> |</li>
        <li class="right" >
          <a href="autobk.html" title="XAFS: Post-edge Background Subtraction"
             >previous</a> |</li>
   <li><a href="../installation.html">download</a>|&nbsp;</li>
   <li><a href="../contents.html">contents</a>|&nbsp;</li>
   <li><a href="../tutorial/index.html">tutorial</a>|&nbsp;</li>
   <li><a href="../plotting/index.html">plot</a>|&nbsp;</li>
   <li><a href="../fitting/index.html">fit</a>|&nbsp;</li>
   <li><a href="index.html">XAFS</a>|&nbsp;</li>
   <li><a href="../xray/index.html">XRF</a>|&nbsp;</li>
   &nbsp;&nbsp;<li><a href="../search.html">search</a>|&nbsp;</li>

          <li><a href="index.html" >XAFS Analysis with Larch</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Matthew Newville.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre.
    </div>
  </body>
</html>