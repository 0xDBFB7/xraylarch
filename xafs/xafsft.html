
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>8.4. XAFS: Fourier Transforms for XAFS &mdash; larch 0.9.28 documentation</title>
    
    <link rel="stylesheet" href="../_static/larchdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.28',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="larch 0.9.28 documentation" href="../index.html" />
    <link rel="up" title="8. XAFS Analysis" href="index.html" />
    <link rel="next" title="8.5. XAFS: Wavelet Transforms for XAFS" href="wavelets.html" />
    <link rel="prev" title="8.3. XAFS: Post-edge Background Subtraction" href="autobk.html" />
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({ "TeX": {Macros: {AA : "{\\unicode{x212B}}"}},
                         "HTML-CSS": {scale: 90}});
  </script>

  </head>
  <body role="document">
<div style=" color: #c5daba;  text-align: left; height:85px; padding: 0px">
<table border=1>
  <tr>
    <td width=20% padding=0 rowspan=2>
	<a href="../index.html">
         <img src="../_static/larchcones.png" height=80px alt="larchcones"/></a>
    </td>
    <td width=54% padding=0>
	<font size=+3><a href="../index.html" style="color: #772211">Larch</a></font>
    </td>
    <td width=8%>
	<a href="../installation/index.html" style="color: #772211"> Install</a>
	</td>
    <td width=8%>
	<a href="http://github.com/xraypy/xraylarch" style="color: #772211"> Develop</a>
        </td>
    <td width=8%>
	<a href="../community.html" style="color: #772211"> Community</a></td>
        </td>
   </tr>
  <tr>
   <td width=54% padding=0>
	 <font size=+2><a href="../index.html" style="color: #772211">
   Data Analysis Tools for X-ray Spectroscopy </a></font>
   </td>
    <td width=8%> <a href="../contents.html" style="color: #772211"> Contents</a></td>
    <td width=8%> <a href="../tutorial/index.html" style="color: #772211"> Tutorial</a></td>
    <td width=8%> <a href="../overview/index.html" style="color: #772211"> Overview</a></td>
   </tr></table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="wavelets.html" title="8.5. XAFS: Wavelet Transforms for XAFS"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="autobk.html" title="8.3. XAFS: Post-edge Background Subtraction"
             accesskey="P">previous</a> |</li>
   <li>[<a href="../data/index.html">Reading Data</a>|</li>
   <li><a href="../plotting/index.html">Plotting</a>|</li>
   <li><a href="../fitting/index.html">Fitting Data</a>|</li>
   <li><a href="index.html">XAFS Analysis</a>|</li>
   <li><a href="../xray/index.html">Xray Databases</a>|</li>
   <li><a href="../xrf/index.html">XRF Analysis</a>|</li>
   <li><a href="../devel/index.html">Scripting</a>]</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">8. XAFS Analysis</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">8.4. XAFS: Fourier Transforms for XAFS</a><ul>
<li><a class="reference internal" href="#overview-of-xafs-fourier-transforms">8.4.1. Overview of XAFS Fourier transforms</a></li>
<li><a class="reference internal" href="#forward-xafs-fourier-transforms">8.4.2. Forward XAFS Fourier transforms (<span class="math">\(k{\rightarrow}R\)</span>)</a></li>
<li><a class="reference internal" href="#reverse-xafs-fourier-transforms">8.4.3. Reverse XAFS Fourier transforms (<span class="math">\(R{\rightarrow}q\)</span>)</a></li>
<li><a class="reference internal" href="#ftwindow-generating-fourier-transform-windows">8.4.4. <code class="docutils literal"><span class="pre">ftwindow()</span></code>: Generating Fourier transform windows</a></li>
<li><a class="reference internal" href="#catalog-of-fourier-transform-window">8.4.5. Catalog of Fourier transform window</a></li>
<li><a class="reference internal" href="#examples-forward-xafs-fourier-transforms">8.4.6. Examples: Forward XAFS Fourier transforms</a></li>
<li><a class="reference internal" href="#examples-reverse-xafs-fourier-transforms-fourier-filtering">8.4.7. Examples: Reverse XAFS Fourier transforms, Fourier Filtering</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="autobk.html"
                        title="previous chapter">8.3. XAFS: Post-edge Background Subtraction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="wavelets.html"
                        title="next chapter">8.5. XAFS: Wavelet Transforms for XAFS</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/xafs/xafsft.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-_xafs">
<span id="xafs-fourier-transforms-for-xafs"></span><span id="xafs-ft-sec"></span><h1>8.4. XAFS: Fourier Transforms for XAFS<a class="headerlink" href="#module-_xafs" title="Permalink to this headline">¶</a></h1>
<p>Fourier transforms are central to understanding and using
XAFS. Consequently, many of the XAFS functions in Larch use XAFS Fourier
transforms as part of their processing, and many of the functions
parameters and arguments described here have names and meanings used
throughout the XAFS functionality of Larch.  For example, both
<a class="reference internal" href="autobk.html#_xafs.autobk" title="_xafs.autobk"><code class="xref py py-func docutils literal"><span class="pre">autobk()</span></code></a> and <a class="reference internal" href="feffit.html#_xafs.feffit" title="_xafs.feffit"><code class="xref py py-func docutils literal"><span class="pre">feffit()</span></code></a> rely on XAFS Fourier transforms, and use
the XAFS Fourier transform function described here.</p>
<div class="section" id="overview-of-xafs-fourier-transforms">
<h2>8.4.1. Overview of XAFS Fourier transforms<a class="headerlink" href="#overview-of-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>The standard Fourier transform of a signal <span class="math">\(f(t)\)</span> can be written as</p>
<div class="math">
\[\begin{eqnarray*}
      {\tilde{f}}(\omega) &amp;=&amp; \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty}
    f(t) e^{-i{\omega}t} dt \\
    f(t) &amp;=&amp; \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty}
    {\tilde{f}}(\omega) e^{i{\omega}t} d{\omega} \\
\end{eqnarray*}\]</div><p>where the symmetric normalization is one of the more common choices of
conventions.  This gives conjugate variables of <span class="math">\(\omega\)</span> and
<span class="math">\(t\)</span>. Because XAFS goes as</p>
<div class="math">
\[\chi(k) \sim \sin[2kR + \delta(k)]\]</div>
<p>the conjugate variables in XAFS are generally taken to be <span class="math">\(k\)</span> and
<span class="math">\(2R\)</span>.  The normalization of <span class="math">\(\tilde\chi(R)\)</span> from a Fourier
transform of <span class="math">\(\chi(k)\)</span> is a matter of convention, but we follow the
symmetric case above (with <span class="math">\(t\)</span> replaced by <span class="math">\(k\)</span> and
<span class="math">\(\omega\)</span> replaced by <span class="math">\(2R\)</span>, and of course <span class="math">\(f\)</span> by
<span class="math">\(\chi\)</span>).</p>
<p>But there are two more important issues to mention.  First, an XAFS Fourier
transform multiplies <span class="math">\(\chi(k)\)</span> by a power of <span class="math">\(k\)</span>, <span class="math">\(k^n\)</span>
and by a window function <span class="math">\(\Omega(k)\)</span> before doing the Fourier
transform.  The power-law weighting allow the oscillations in <span class="math">\(k\)</span> to
emphasize different portions of the spectra, or to give a uniform intensity
to the oscillations.  The window function acts to smooth the resulting
Fourier transform and remove ripple and ringing in it that would result
from a sudden truncation of <span class="math">\(\chi(k)\)</span> at the end of the data range.</p>
<p>The second important issue is that the continuous Fourier transform
described above is replaced by a discrete transform.  This better matches
the discrete sampling of energy and <span class="math">\(k\)</span> values of the data, and
allows Fast Fourier Transform techniques to be used.  It does change the
definitions of the transforms used somewhat. First, the <span class="math">\(\chi(k)\)</span>
data must be on <em>uniformly spaced</em> set of <span class="math">\(k\)</span> values.  The default
<span class="math">\(k\)</span> spacing used in Larch (including as output from <a class="reference internal" href="autobk.html#_xafs.autobk" title="_xafs.autobk"><code class="xref py py-func docutils literal"><span class="pre">autobk()</span></code></a>)
is <span class="math">\(\delta k\)</span> = 0.05 <span class="math">\(\rm\AA^{-1}\)</span>.  Second, the array size for
<span class="math">\(\chi(k)\)</span> used in the Fourier transform should be a power of 2. The
default used in Larch is <span class="math">\(N_{\rm fft}\)</span> = 2048.   Together, these
allow <span class="math">\(\chi(k)\)</span> data to 102.4 <span class="math">\(\rm\AA^{-1}\)</span>.  Of course, real
data doesn't extend that far, so the array to be transformed is
<em>zero-padded</em> to the end of the range.  Since the spacing <span class="math">\(\delta R\)</span>
of the resulting discrete <span class="math">\(\chi(R)\)</span> is given as
<span class="math">\(\pi/{(N_{\rm fft} \delta k )}\)</span>, the extended range and zero-padding
will increase the density of points in <span class="math">\(\chi(R)\)</span>, smoothly
interpolating the values.   For <span class="math">\(N_{\rm fft}\)</span> = 2048 and
<span class="math">\(\delta k\)</span> =  0.05 <span class="math">\(\rm\AA^{-1}\)</span>, the <span class="math">\(R\)</span> spacing is
approximately <span class="math">\(\delta R\)</span> =  0.0307 <span class="math">\(\rm\AA\)</span>.</p>
<p>For the discrete Fourier transforms with samples of <span class="math">\(\chi(k)\)</span> at the
points <span class="math">\(k_n = n \, \delta k\)</span>, and samples of <span class="math">\(\chi(R)\)</span> at the
points <span class="math">\(R_m = m \, \delta R\)</span>, the definitions become:</p>
<div class="math">
\[\begin{eqnarray*}
\tilde\chi(R_m) &amp;=&amp; \frac{i \delta k}{\sqrt{\pi N_{\rm fft}}} \,
                    \sum_{n=1}^{N_{\rm fft}} \chi(k_n) \,
                    \Omega(k_n) \, k_n^w e^{2i\pi n m/N_{\rm fft}} \\
\tilde\chi(k_n) &amp;=&amp; \frac{2 i \delta R}{\sqrt{\pi N_{\rm fft}}} \,
                    \sum_{m=1}^{N_{\rm fft}} \tilde\chi(R_m) \,
                    \Omega(R_m) \, e^{-2i\pi n m/N_{\rm fft}} \\
\end{eqnarray*}\]</div><p>These normalizations preserve the symmetry properties of the Fourier
Transforms with conjugate variables <span class="math">\(k\)</span> and <span class="math">\(2R\)</span>.
Though the reverse transform converts the complex <span class="math">\(\chi(R)\)</span> to the
complex <span class="math">\(\chi(k)\)</span> on the same <span class="math">\(k\)</span> spacing as the starting
data, we often refer to the filtered <span class="math">\(\chi(k)\)</span> as <em>q</em> space.</p>
<p>A final complication in using Fourier transforms for XAFS is that the
measured <span class="math">\(\mu(E)\)</span> and <span class="math">\(\chi(k)\)</span> are a strictly real values,
while the Fourier transform inherently treats <span class="math">\(\chi(k)\)</span> and
<span class="math">\(\chi(R)\)</span> as complex values. This leads to an ambiguity about how to
construct the complex <span class="math">\(\tilde\chi(k)\)</span>.  In many formal treatments,
XAFS is written as the imaginary part of a complex function.  This might
lead one to assume that constructing <span class="math">\(\tilde\chi(k)\)</span> as <span class="math">\(0 +
i\chi(k)\)</span> would be the natural choice.  For historical reasons, Larch uses
the opposite convention, constructing <span class="math">\(\tilde\chi(k)\)</span> as
<span class="math">\(\chi(k) + 0i\)</span>.   As we'll see below, you can easily change this
convention.  The effect of this choice is minor unless one is
concerned about the differences of the real and imaginary parts of
<span class="math">\(\chi(R)\)</span> or one is intending to filter and back-transform the
<span class="math">\(\chi(R)\)</span> and compare the filtered and unfiltered data.</p>
</div>
<div class="section" id="forward-xafs-fourier-transforms">
<h2>8.4.2. Forward XAFS Fourier transforms (<span class="math">\(k{\rightarrow}R\)</span>)<a class="headerlink" href="#forward-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>The forward Fourier transform converts <span class="math">\(\chi(k)\)</span> to <span class="math">\(\chi(R)\)</span>
and is of primary importance for XAFS analysis.  In Larch, this is
encapsulated in the <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal"><span class="pre">xftf()</span></code></a> function.</p>
<dl class="function">
<dt id="_xafs.xftf">
<code class="descclassname">_xafs.</code><code class="descname">xftf</code><span class="sig-paren">(</span><em>k</em>, <em>chi=None</em>, <em>group=None</em>, <em>...</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.xftf" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a forward XAFS Fourier transform, from <span class="math">\(\chi(k)\)</span> to
<span class="math">\(\chi(R)\)</span>, using common XAFS conventions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> -- 1-d array of photo-electron wavenumber in <span class="math">\(\rm\AA^{-1}\)</span></li>
<li><strong>chi</strong> -- 1-d array of <span class="math">\(\chi\)</span></li>
<li><strong>group</strong> -- output Group</li>
<li><strong>rmax_out</strong> -- highest <em>R</em> for output data (10 <span class="math">\(\rm\AA\)</span>)</li>
<li><strong>kweight</strong> -- exponent for weighting spectra by <span class="math">\(k^{\rm kweight}\)</span></li>
<li><strong>kmin</strong> -- starting <em>k</em> for FT Window</li>
<li><strong>kmax</strong> -- ending <em>k</em> for FT Window</li>
<li><strong>dk</strong> -- tapering parameter for FT Window</li>
<li><strong>dk2</strong> -- second tapering parameter for FT Window</li>
<li><strong>window</strong> -- name of window type</li>
<li><strong>nfft</strong> -- value to use for <span class="math">\(N_{\rm fft}\)</span> (2048).</li>
<li><strong>kstep</strong> -- value to use for <span class="math">\(\delta{k}\)</span> (0.05).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code> -- outputs are written to supplied group.</p>
</td>
</tr>
</tbody>
</table>
<p>Follows the First Argument Group convention, using group members named <code class="docutils literal"><span class="pre">k</span></code> and <code class="docutils literal"><span class="pre">chi</span></code>.
The following data is put into the output group:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">array name</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>kwin</td>
<td>window <span class="math">\(\Omega(k)\)</span> (length of input chi(k)).</td>
</tr>
<tr class="row-odd"><td>r</td>
<td>uniform array of <span class="math">\(R\)</span>, out to <code class="docutils literal"><span class="pre">rmax_out</span></code>.</td>
</tr>
<tr class="row-even"><td>chir</td>
<td>complex array of <span class="math">\(\tilde\chi(R)\)</span>.</td>
</tr>
<tr class="row-odd"><td>chir_mag</td>
<td>magnitude of <span class="math">\(\tilde\chi(R)\)</span>.</td>
</tr>
<tr class="row-even"><td>chir_pha</td>
<td>phase of <span class="math">\(\tilde\chi(R)\)</span>.</td>
</tr>
<tr class="row-odd"><td>chir_re</td>
<td>real part of <span class="math">\(\tilde\chi(R)\)</span>.</td>
</tr>
<tr class="row-even"><td>chir_im</td>
<td>imaginary part of <span class="math">\(\tilde\chi(R)\)</span>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>It is expected that the input <code class="docutils literal"><span class="pre">k</span></code> be a uniformly spaced array of
values with spacing <code class="docutils literal"><span class="pre">kstep</span></code>, starting a 0.  If it is not, the <code class="docutils literal"><span class="pre">k</span></code>
and <code class="docutils literal"><span class="pre">chi</span></code> data will be linearly interpolated onto the proper grid.</p>
<p>The FT window parameters are explained in more detail in the discussion of
<a class="reference internal" href="#_xafs.ftwindow" title="_xafs.ftwindow"><code class="xref py py-func docutils literal"><span class="pre">ftwindow()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="_xafs.xftf_fast">
<code class="descclassname">_xafs.</code><code class="descname">xftf_fast</code><span class="sig-paren">(</span><em>chi</em>, <em>nfft=2048</em>, <em>kstep=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.xftf_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a forward XAFS Fourier transform, from <span class="math">\(\chi(k)\)</span> to
<span class="math">\(\chi(R)\)</span>, using common XAFS conventions.  This version demands
<code class="docutils literal"><span class="pre">chi</span></code> to include any weighting and windowing, and so to represent
<span class="math">\(\chi(k)k^w\Omega(k)\)</span> on a uniform <span class="math">\(k\)</span> grid. It returns
the complex array of <span class="math">\(\chi(R)\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chi</strong> -- 1-d array of <span class="math">\(\chi\)</span> to be transformed</li>
<li><strong>nfft</strong> -- value to use for <span class="math">\(N_{\rm fft}\)</span> (2048).</li>
<li><strong>kstep</strong> -- value to use for <span class="math">\(\delta{k}\)</span> (0.05).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">complex <span class="math">\(\chi(R)\)</span>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="reverse-xafs-fourier-transforms">
<h2>8.4.3. Reverse XAFS Fourier transforms (<span class="math">\(R{\rightarrow}q\)</span>)<a class="headerlink" href="#reverse-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>Reverse Fourier transforms convert <span class="math">\(\chi(R)\)</span> back to filtered
<span class="math">\(\chi(k)\)</span>.  We refer to the filtered <span class="math">\(k\)</span> space as <span class="math">\(q\)</span> to
emphasize the distinction between the two.  The filtered <span class="math">\(\chi(q)\)</span> is
complex.  By convention, the real part of <span class="math">\(\chi(q)\)</span> corresponds to
the explicitly real <span class="math">\(\chi(k)\)</span>.</p>
<dl class="function">
<dt id="_xafs.xftr">
<code class="descclassname">_xafs.</code><code class="descname">xftr</code><span class="sig-paren">(</span><em>r</em>, <em>chir</em>, <em>group=None</em>, <em>...</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.xftr" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a reverse XAFS Fourier transform, from <span class="math">\(\chi(R)\)</span> to
<span class="math">\(\chi(q)\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> -- 1-d array of distance.</li>
<li><strong>chir</strong> -- 1-d array of <span class="math">\(\chi(R)\)</span></li>
<li><strong>group</strong> -- output Group</li>
<li><strong>qmax_out</strong> -- highest <em>k</em> for output data (30 <span class="math">\(\rm\AA^{-1}\)</span>)</li>
<li><strong>rweight</strong> -- exponent for weighting spectra by <span class="math">\(r^{\rm rweight}\)</span> (0)</li>
<li><strong>rmin</strong> -- starting <em>R</em> for FT Window</li>
<li><strong>rmax</strong> -- ending <em>R</em> for FT Window</li>
<li><strong>dr</strong> -- tapering parameter for FT Window</li>
<li><strong>dr2</strong> -- second tapering parameter for FT Window</li>
<li><strong>window</strong> -- name of window type</li>
<li><strong>nfft</strong> -- value to use for <span class="math">\(N_{\rm fft}\)</span> (2048).</li>
<li><strong>kstep</strong> -- value to use for <span class="math">\(\delta{k}\)</span> (0.05).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">None</span></code> -- outputs are written to supplied group.</p>
</td>
</tr>
</tbody>
</table>
<p>Follows the First Argument Group convention, using group members named <code class="docutils literal"><span class="pre">r</span></code> and <code class="docutils literal"><span class="pre">chir</span></code>.
The following data is put into the output group:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">array name</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>rwin</td>
<td>window <span class="math">\(\Omega(R)\)</span> (length of input chi(R)).</td>
</tr>
<tr class="row-odd"><td>q</td>
<td>uniform array of <span class="math">\(k\)</span>, out to <code class="docutils literal"><span class="pre">qmax_out</span></code>.</td>
</tr>
<tr class="row-even"><td>chiq</td>
<td>complex array of <span class="math">\(\tilde\chi(k)\)</span>.</td>
</tr>
<tr class="row-odd"><td>chiq_mag</td>
<td>magnitude of <span class="math">\(\tilde\chi(k)\)</span>.</td>
</tr>
<tr class="row-even"><td>chiq_pha</td>
<td>phase of <span class="math">\(\tilde\chi(k)\)</span>.</td>
</tr>
<tr class="row-odd"><td>chiq_re</td>
<td>real part of <span class="math">\(\tilde\chi(k)\)</span>.</td>
</tr>
<tr class="row-even"><td>chiq_im</td>
<td>imaginary part of <span class="math">\(\tilde\chi(k)\)</span>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>In analogy with <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal"><span class="pre">xftf()</span></code></a>, it is expected that the input <code class="docutils literal"><span class="pre">r</span></code> be a
uniformly spaced array of values starting a 0.</p>
<p>The input <code class="docutils literal"><span class="pre">chir</span></code> array can be either the complex <span class="math">\(\chi(R)\)</span> array
as output to <code class="docutils literal"><span class="pre">Group.chir</span></code> from <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal"><span class="pre">xftf()</span></code></a>, or one of the real or
imaginary parts of the <span class="math">\(\chi(R)\)</span> as output to <code class="docutils literal"><span class="pre">Group.chir_re</span></code> or
<code class="docutils literal"><span class="pre">Group.chir_im</span></code>.</p>
<p>The FT window parameters are explained in more detail in the discussion of
<a class="reference internal" href="#_xafs.ftwindow" title="_xafs.ftwindow"><code class="xref py py-func docutils literal"><span class="pre">ftwindow()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="_xafs.xftr_fast">
<code class="descclassname">_xafs.</code><code class="descname">xftr_fast</code><span class="sig-paren">(</span><em>chir</em>, <em>nfft=2048</em>, <em>kstep=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.xftr_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a reverse XAFS Fourier transform, from <span class="math">\(\chi(R)\)</span> to
<span class="math">\(\chi(q)\)</span>, using common XAFS conventions.  This version demands
<code class="docutils literal"><span class="pre">chir</span></code> be  the complex <span class="math">\(\chi(R)\)</span> as created from <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal"><span class="pre">xftf()</span></code></a>.
It returns the complex array of <span class="math">\(\chi(q)\)</span> without putting any
values into a group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chir</strong> -- 1-d array of <span class="math">\(\chi(R)\)</span> to be transformed</li>
<li><strong>nfft</strong> -- value to use for <span class="math">\(N_{\rm fft}\)</span> (2048).</li>
<li><strong>kstep</strong> -- value to use for <span class="math">\(\delta{k}\)</span> (0.05).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">complex <span class="math">\(\chi(q)\)</span>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="ftwindow-generating-fourier-transform-windows">
<h2>8.4.4. <a class="reference internal" href="#_xafs.ftwindow" title="_xafs.ftwindow"><code class="xref py py-func docutils literal"><span class="pre">ftwindow()</span></code></a>: Generating Fourier transform windows<a class="headerlink" href="#ftwindow-generating-fourier-transform-windows" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above, a Fourier transform window will smooth the resulting
Fourier transformed spectrum, removing ripple and ringing in it that would
result from a sudden truncation data at the end of it range.  There is an
extensive literature on such windows, and a lot of choices and parameters
available for constructing windows.  A sampling of windows is shown below.</p>
<dl class="function">
<dt id="_xafs.ftwindow">
<code class="descclassname">_xafs.</code><code class="descname">ftwindow</code><span class="sig-paren">(</span><em>x</em>, <em>xmin=0</em>, <em>xmax=None</em>, <em>dk=1</em>, <em>...</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.ftwindow" title="Permalink to this definition">¶</a></dt>
<dd><p>create a Fourier transform window array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> -- 1-d array array to build window on.</li>
<li><strong>xmin</strong> -- starting <em>x</em> for FT Window</li>
<li><strong>xmax</strong> -- ending <em>x</em> for FT Window</li>
<li><strong>dx</strong> -- tapering parameter for FT Window</li>
<li><strong>dx2</strong> -- second tapering parameter for FT Window (=dx)</li>
<li><strong>window</strong> -- name of window type</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">1-d window array.</p>
</td>
</tr>
</tbody>
</table>
<p>Note that if <code class="docutils literal"><span class="pre">dx</span></code> is specified but <code class="docutils literal"><span class="pre">dx2</span></code> is not, <code class="docutils literal"><span class="pre">dx2</span></code> will
generally take the same value as <code class="docutils literal"><span class="pre">dx</span></code>.</p>
<p>The window type must be one of those listed in the <a class="reference internal" href="#xafs-ftwin-table"><span>Table of
Fourier Transform Window Types</span></a>.</p>
</dd></dl>

<blockquote id="xafs-ftwin-table">
<span id="index-0"></span><div><p>Table of Fourier Transform Window Types.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">window name</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>hanning</td>
<td>cosine-squared taper</td>
</tr>
<tr class="row-odd"><td>parzen</td>
<td>linear taper</td>
</tr>
<tr class="row-even"><td>welch</td>
<td>quadratic taper</td>
</tr>
<tr class="row-odd"><td>gaussian</td>
<td>Gaussian (normal) function window</td>
</tr>
<tr class="row-even"><td>sine</td>
<td>sine function window</td>
</tr>
<tr class="row-odd"><td>kaiser</td>
<td>Kaiser-Bessel function-derived window</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>In general, the window arrays have a value that gradually increases from 0
up to 1 at the low-k end, may stay with a value 1 over some central
portion, and then tapers down to 0 at the high-k end.  The meaning of the
<code class="docutils literal"><span class="pre">dx</span></code> and <code class="docutils literal"><span class="pre">dx2</span></code>, and even <code class="docutils literal"><span class="pre">xmin</span></code>, and <code class="docutils literal"><span class="pre">xmax</span></code> varies a bit for the
different window types.  The Hanning, Parzen, and Welch windows share a
convention that the windows taper up from 0 to 1 between <code class="docutils literal"><span class="pre">xmin-dx/2</span></code> and
<code class="docutils literal"><span class="pre">xmin+dx/2</span></code>, and then taper down from 1 to 0 between <code class="docutils literal"><span class="pre">xmax-dx2/2</span></code> and
<code class="docutils literal"><span class="pre">xmax+dx2/2</span></code>.</p>
<p>The conventions for the Kaiser, Gaussian, and Sine window types is a bit
more complicated, and is best given explicitly.  In the formulas below,
<code class="docutils literal"><span class="pre">dx</span></code> written as <span class="math">\(dx\)</span> and <code class="docutils literal"><span class="pre">dx2</span></code> as <span class="math">\(dx_2\)</span>.  We
define <span class="math">\(x_i = x_{\rm min} - dx/2\)</span>, <span class="math">\(x_f = x_{\rm max} +
dx_2/2\)</span>, and <span class="math">\(x_0 = (x_f + x_i)/2\)</span>, as the beginning, end, and
center of the widows.  For the Gaussian window, the form is:</p>
<div class="math">
\[\Omega(x) = \exp{\bigl[ -\frac{(x - x_0)^2}{2{dx}^2}\bigr]}\]</div>
<p>The form for the Sine window is</p>
<div class="math">
\[\Omega(x) = \sin{\bigl[ \frac{ \pi(x_f - x)}{x_f - x_i}\bigr]}\]</div>
<p>between <span class="math">\(x_i\)</span>  and  <span class="math">\(x_f\)</span>, and 0 outside this range.
The Kaiser-Bessel window is slightly more complicated:</p>
<div class="math">
\[\begin{eqnarray*}
   a       &amp;=&amp; \sqrt{\max{\bigl[0, 1 - \frac{4(x-x_0)^2}{(x_f-x_i)^2} \bigr] }} \\
  \Omega(x) &amp;=&amp; \frac{i_0(a dx) - 1}{i_0(dx) - 1} \\
\end{eqnarray*}\]</div><p>where <span class="math">\(i_0\)</span> is the modified Bessel function of order 0.</p>
</div>
<div class="section" id="catalog-of-fourier-transform-window">
<h2>8.4.5. Catalog of Fourier transform window<a class="headerlink" href="#catalog-of-fourier-transform-window" title="Permalink to this headline">¶</a></h2>
<p>Here, we give a series of example windows, to illustrate the different
window types and the effect of the various parameters.  The meanings of
<code class="docutils literal"><span class="pre">xmin</span></code>, <code class="docutils literal"><span class="pre">xmax</span></code>, <code class="docutils literal"><span class="pre">dx</span></code> and <code class="docutils literal"><span class="pre">dx2</span></code> are identical for the Hanning, Parzen and
Welch windows, and illustrated in the two following figures.</p>
<div class="figure compound align-center" id="fig-xafsft1">
<div style="width: 45%" class="subfigure" id="fig-xafsft1a">
<a class="reference external image-reference" href="../_images/ftwin_example1.png"><img alt="../_images/ftwin_example1.png" src="../_images/ftwin_example1.png" style="width: 100%;" /></a>
</div>
<div style="width: 45%" class="subfigure" id="fig-xafsft1b">
<a class="reference external image-reference" href="../_images/ftwin_example2.png"><img alt="../_images/ftwin_example2.png" src="../_images/ftwin_example2.png" style="width: 100%;" /></a>
</div>
<p class="caption"><span class="caption-text"><strong>Figure 8.11:</strong> Fourier Transform window examples and illustration of parameter meaning
for the Hanning, Parzen, and Welch windows.  Note that
<span class="math">\(\Omega(x=x_{\rm min}) = \Omega(x=x_{\rm max}) = 0.5\)</span>, and that
the meaning of <code class="docutils literal"><span class="pre">dx</span></code> is to control the taper over which the window
changes from 0 to 1.  Here, <code class="docutils literal"><span class="pre">xmin=5</span></code> and <code class="docutils literal"><span class="pre">xmax=15</span></code>.</span></p>
</div><p id="fig-xafsft1">Some more window functions:</p>
<div class="figure compound align-center" id="fig-xafsft2">
<div style="width: 45%" class="subfigure" id="fig-xafsft2a">
<a class="reference external image-reference" href="../_images/ftwin_example3.png"><img alt="../_images/ftwin_example3.png" src="../_images/ftwin_example3.png" style="width: 100%;" /></a>
</div>
<div style="width: 45%" class="subfigure" id="fig-xafsft2b">
<a class="reference external image-reference" href="../_images/ftwin_example4.png"><img alt="../_images/ftwin_example4.png" src="../_images/ftwin_example4.png" style="width: 100%;" /></a>
</div>
<p class="caption"><span class="caption-text"><strong>Figure 8.12:</strong> Fourier Transform window examples and illustration of parameter
meaning.  On the left, a comparison of Welch, Parzen, and Hanning with
the same parameters is shown.  On the right, the effect of <code class="docutils literal"><span class="pre">dx2</span></code> is
shown as a different amount of taper on the high- and low-<code class="docutils literal"><span class="pre">x</span></code> end of
the window.  As before, <code class="docutils literal"><span class="pre">xmin=5</span></code> and <code class="docutils literal"><span class="pre">xmax=15</span></code>.</span></p>
</div><p id="fig-xafsft2">The Gaussian, Sine, and Kaiser-Bessel windows are illustrated next. These
go to 1 at the average of <code class="docutils literal"><span class="pre">xmin</span></code> and <code class="docutils literal"><span class="pre">xmax</span></code>, but do not stay at 1 over
a central portion of the window -- they taper continuously.  The Gaussian
window is a simple Gaussian function, and is not truncated according to
<code class="docutils literal"><span class="pre">xmin</span></code> and <code class="docutils literal"><span class="pre">xmax</span></code>, and the <code class="docutils literal"><span class="pre">dx</span></code> parameter sets the width.  The Sine
and Kaiser-Bessel windows both go to zero at  <code class="docutils literal"><span class="pre">xmin-dx/2</span></code> and <code class="docutils literal"><span class="pre">xmax</span> <span class="pre">+</span>
<span class="pre">dx/2</span></code>.  For very large values of <code class="docutils literal"><span class="pre">dx</span></code>, the Kaiser-Bessel window
approaches a nearly Gaussian lineshape.</p>
<div class="figure compound align-center" id="fig-xafsft3">
<div style="width: 45%" class="subfigure" id="fig-xafsft3a">
<a class="reference external image-reference" href="../_images/ftwin_example5.png"><img alt="../_images/ftwin_example5.png" src="../_images/ftwin_example5.png" style="width: 100%;" /></a>
</div>
<div style="width: 45%" class="subfigure" id="fig-xafsft3b">
<a class="reference external image-reference" href="../_images/ftwin_example6.png"><img alt="../_images/ftwin_example6.png" src="../_images/ftwin_example6.png" style="width: 100%;" /></a>
</div>
<p class="caption"><span class="caption-text"><strong>Figure 8.13:</strong> Fourier Transform windows. On the left, a comparison of Kaiser-Bessel,
Sine, and Gaussian windows with the same parameters is shown.  On the
right, the effect of <code class="docutils literal"><span class="pre">dx</span></code> is shown for the Kaiser-Bessel window, and
a closer comparison to a Gaussian window is made.</span></p>
</div></div>
<div class="section" id="examples-forward-xafs-fourier-transforms">
<span id="fig-xafsft3"></span><h2>8.4.6. Examples: Forward XAFS Fourier transforms<a class="headerlink" href="#examples-forward-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>Now we show some example Fourier transforms, illustrating the real and
imaginary parts of the <span class="math">\(\chi(R)\)</span> as well as the magnitude, the effect
of different windows types, and Fourier filtering to <span class="math">\(\chi(q)\)</span>.  We
use a single XAFS dataset from FeO for all these examples, with a
well-separated first and second shell.  The full scripts to generate the
figures shown here are included in the <em>examples/xafs/</em> folder.</p>
<p>We start with a comparison of a small value of <code class="docutils literal"><span class="pre">dk</span></code> and a larger value.
A script that runs <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal"><span class="pre">xftf()</span></code></a>, changing on <code class="docutils literal"><span class="pre">dk</span></code> would look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xftf</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hanning&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat1</span><span class="p">)</span>

<span class="n">dat2</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c1"># make a copy of the group</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat2</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat2</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hanning&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat2</span><span class="p">)</span>
</pre></div>
</div>
<p>would result in the following results:</p>
<div class="figure compound align-center" id="fig-xafsft4">
<div style="width: 45%" class="subfigure" id="fig-xafsft4a">
<a class="reference external image-reference" href="../_images/xft_example1.png"><img alt="../_images/xft_example1.png" src="../_images/xft_example1.png" style="width: 100%;" /></a>
</div>
<div style="width: 45%" class="subfigure" id="fig-xafsft4b">
<a class="reference external image-reference" href="../_images/xft_example2.png"><img alt="../_images/xft_example2.png" src="../_images/xft_example2.png" style="width: 100%;" /></a>
</div>
<p class="caption"><span class="caption-text"><strong>Figure 8.14:</strong> Comparison of the effect of different values of <code class="docutils literal"><span class="pre">dk</span></code> on real XAFS
Fourier transforms.  Increasing <code class="docutils literal"><span class="pre">dk</span></code> reduces peak heights and tends
to broaden peaks, but the effects are rather small.</span></p>
</div><p id="fig-xafsft4">A script that runs <a class="reference internal" href="#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal"><span class="pre">xftf()</span></code></a> with consistent parameters, but different
window types:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">xftf</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hanning&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat1</span><span class="p">)</span>

<span class="n">dat2</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c1"># make a copy of the group</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat2</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat2</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;parzen&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat2</span><span class="p">)</span>

<span class="n">dat3</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat3</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat3</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;welch&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat3</span><span class="p">)</span>

<span class="n">dat4</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat4</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat4</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;kaiser&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat4</span><span class="p">)</span>

<span class="n">dat5</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat5</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat5</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat5</span><span class="p">)</span>
</pre></div>
</div>
<p>would result in the following results:</p>
<div class="figure compound align-center" id="fig-xafsft_wins">
<div style="width: 45%" class="subfigure" id="fig-xafsft-winsa">
<a class="reference external image-reference" href="../_images/xft_example3.png"><img alt="../_images/xft_example3.png" src="../_images/xft_example3.png" style="width: 100%;" /></a>
</div>
<div style="width: 45%" class="subfigure" id="fig-xafsft-winsb">
<a class="reference external image-reference" href="../_images/xft_example4.psng"><img alt="../_images/xft_example4.png" src="../_images/xft_example4.png" style="width: 100%;" /></a>
</div>
<p class="caption"><span class="caption-text"><strong>Figure 8.15:</strong> Comparison of the effect of different window types on real XAFS Fourier
transforms.</span></p>
</div><p id="fig-xafsft_wins">We now turn our attention to the different components of the Fourier
transform.  As above, it is most common to plot the magnitude of the
Fourier transform.  But, as the transformed <span class="math">\(\chi(R)\)</span> is complex, it
can be instructive to plot the real and imaginary components, as shown
below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">newplot</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chir_mag</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chir_mag&#39;</span><span class="p">,</span>
        <span class="n">show_legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;ur&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="s1">r&#39;$R \rm\, (\AA)$&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">r&#39;$\chi(R)\rm\,(\AA^{-3})$&#39;</span> <span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chir_re</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chir_re&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chir_im</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chir_im&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>which results in</p>
<div class="figure align-center" id="id1">
<span id="fig-xafsft-ri"></span><a class="reference external image-reference" href="../_images/xft_example5.png"><img alt="../_images/xft_example5.png" src="../_images/xft_example5.png" style="width: 65%;" /></a>
<p class="caption"><span class="caption-text"><strong>Figure 10.1:</strong> The real and imaginary components of the XAFS Fourier transform.</span></p>
</div>
<p>In fact, in the analysis discussed with <a class="reference internal" href="feffit.html#_xafs.feffit" title="_xafs.feffit"><code class="xref py py-func docutils literal"><span class="pre">feffit()</span></code></a>, the real and
imaginary components are used, not simply the magnitude.</p>
</div>
<div class="section" id="examples-reverse-xafs-fourier-transforms-fourier-filtering">
<h2>8.4.7. Examples: Reverse XAFS Fourier transforms, Fourier Filtering<a class="headerlink" href="#examples-reverse-xafs-fourier-transforms-fourier-filtering" title="Permalink to this headline">¶</a></h2>
<p>A reverse Fourier transform will convert data from <span class="math">\(\chi(R)\)</span> to
<span class="math">\(\chi(q)\)</span>.  This allows a limited range of frequencies (distances) to
be isolated and turned back into a <span class="math">\(\chi(k)\)</span> spectrum.  Here, we show
two different <span class="math">\(R\)</span> windows to filter either just the first shell of
the spectra, or the first two shells, and compare the resulting filtered
<span class="math">\(\chi(q)\)</span>.</p>
<div class="figure compound align-center" id="fig_xafsft_filter">
<div style="width: 45%" class="subfigure" id="fig-xafsft-filtera">
<a class="reference external image-reference" href="../_images/xft_example6.png"><img alt="../_images/xft_example6.png" src="../_images/xft_example6.png" style="width: 100%;" /></a>
</div>
<div style="width: 45%" class="subfigure" id="fig-xafsft-filterb">
<a class="reference external image-reference" href="../_images/xft_example7.png"><img alt="../_images/xft_example7.png" src="../_images/xft_example7.png" style="width: 100%;" /></a>
</div>
<p class="caption"><span class="caption-text"><strong>Figure 8.18:</strong> Reverse XAFS Fourier transform, or Fourier filtering.  Here, one can
see the effect of different window sizes on the Fourier filtered
spectrum.  Including the first two peaks or shells reproduces most of
the original spectrum, with only high-frequency components removed.</span></p>
</div><p id="fig_xafsft_filter">Note that it is <code class="docutils literal"><span class="pre">chiq_re</span></code> that is compared to the k-weighted <code class="docutils literal"><span class="pre">chi</span></code>
array.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="wavelets.html" title="8.5. XAFS: Wavelet Transforms for XAFS"
             >next</a> |</li>
        <li class="right" >
          <a href="autobk.html" title="8.3. XAFS: Post-edge Background Subtraction"
             >previous</a> |</li>
   <li>[<a href="../data/index.html">Reading Data</a>|</li>
   <li><a href="../plotting/index.html">Plotting</a>|</li>
   <li><a href="../fitting/index.html">Fitting Data</a>|</li>
   <li><a href="index.html">XAFS Analysis</a>|</li>
   <li><a href="../xray/index.html">Xray Databases</a>|</li>
   <li><a href="../xrf/index.html">XRF Analysis</a>|</li>
   <li><a href="../devel/index.html">Scripting</a>]</li>

          <li class="nav-item nav-item-1"><a href="index.html" >8. XAFS Analysis</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright Matthew Newville, The University of Chicago, 2012.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>