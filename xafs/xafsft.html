

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>XAFS: Fourier Transforms for XAFS &mdash; larch 0.9.14 documentation</title>
    
    <link rel="stylesheet" href="../_static/larchdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.14',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="larch 0.9.14 documentation" href="../index.html" />
    <link rel="up" title="XAFS Analysis with Larch" href="index.html" />
    <link rel="next" title="XAFS: Fitting XAFS to Feff Paths" href="feffit.html" />
    <link rel="prev" title="XAFS: Post-edge Background Subtraction" href="autobk.html" /> 
  </head>
  <body>
<div style=" color: #76989B; text-align: left; 
            height:95px; padding: 1px 0px 0px 3px">
<table><tr><td>
   <a href="../index.html">
      <img src="../_static/larchcones.png" height=90 alt="larchcones"/>
   </a></td><td padding=0>
      <font size=+3><a href="../index.html" style="color: #662211">
        &nbsp; Larch: X-ray Data Analysis   </a></font>
</td></tr></table>
</div>


    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="feffit.html" title="XAFS: Fitting XAFS to Feff Paths"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="autobk.html" title="XAFS: Post-edge Background Subtraction"
             accesskey="P">previous</a> |</li>
   <li><a href="../installation.html">download</a>|&nbsp;</li>
   <li><a href="../contents.html">contents</a>|&nbsp;</li>
   <li><a href="../tutorial/index.html">tutorial</a>|&nbsp;</li>
   <li><a href="index.html">XAFS analysis</a>|&nbsp;</li>
   <li><a href="../xray/index.html">XRF analysis</a>|&nbsp;</li>
   &nbsp;&nbsp;<li><a href="../search.html">search</a>&nbsp;</li>

          <li><a href="index.html" accesskey="U">XAFS Analysis with Larch</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">XAFS: Fourier Transforms for XAFS</a><ul>
<li><a class="reference internal" href="#overview-of-xafs-fourier-transforms">Overview of XAFS Fourier transforms</a></li>
<li><a class="reference internal" href="#fourier-transform-windows">Fourier transform windows</a></li>
<li><a class="reference internal" href="#forward-xafs-fourier-transforms">Forward XAFS Fourier transforms (<img class="math" src="../_images/math/74a778df2be28afb0293f1bd3948fe7da53cf082.png" alt="k{\rightarrow}R"/>)</a></li>
<li><a class="reference internal" href="#inverse-xafs-fourier-transforms">Inverse XAFS Fourier transforms (<img class="math" src="../_images/math/355651533ada75aa6ca33a45d111bf5553d4301c.png" alt="R{\rightarrow}q"/>)</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="autobk.html"
                        title="previous chapter">XAFS: Post-edge Background Subtraction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="feffit.html"
                        title="next chapter">XAFS: Fitting XAFS to Feff Paths</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/xafs/xafsft.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="xafs-fourier-transforms-for-xafs">
<h1>XAFS: Fourier Transforms for XAFS<a class="headerlink" href="#xafs-fourier-transforms-for-xafs" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">synopsis:</th><td class="field-body">XAFS Fourier transform functions</td>
</tr>
</tbody>
</table>
<p>Fourier transforms are central to understanding and using
XAFS. Consequently, many of the XAFS functions in Larch use XAFS Fourier
transforms as part of their processing.  For example, but <a class="reference internal" href="autobk.html#autobk" title="autobk"><tt class="xref py py-func docutils literal"><span class="pre">autobk()</span></tt></a>
and <tt class="xref py py-func docutils literal"><span class="pre">feffit()</span></tt> rely on XAFS Fourier transforms, as well as the specific
XAFS Fourier transform function described in this section.  The details of
these transforms will be described in detail in this section.  Many of
these functions share parametersa and arguments with similar names and
meanings.</p>
<div class="section" id="overview-of-xafs-fourier-transforms">
<h2>Overview of XAFS Fourier transforms<a class="headerlink" href="#overview-of-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>Standard Fourier transform of a signal <img class="math" src="../_images/math/1411b4cdb90fcfd2f55c9c77320893b4b4d6d911.png" alt="f(t)"/> can be written as</p>
<div class="math">
<p><img src="../_images/math/1cfed1a7439bb0126593f6fc3852b91ad3b4a7ff.png" alt="\begin{eqnarray*}
      {\tilde{f}}(\omega) &amp;=&amp; \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty}
    f(t) e^{-i{\omega}t} dt \\
    f(t) &amp;=&amp; \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty}
    {\tilde{f}}(\omega) e^{i{\omega}t} d{\omega} \\
\end{eqnarray*}"/></p>
</div><p>where the symmetric normalization is one of the more common choices of
conventions.  This gives conjugate variables of <img class="math" src="../_images/math/54d7d48553f4d9e7ab418118607ea324cbfddfda.png" alt="\omega"/> and
<img class="math" src="../_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>. Because XAFS goes as</p>
<div class="math">
<p><img src="../_images/math/30bac55e7dd9e447f4a9bd4b7b908dc6b713004b.png" alt="\chi(k) \sim \sin[2kR + \delta(k)]"/></p>
</div><p>the conjugate variables in XAFS are generally taken to be <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> and
<img class="math" src="../_images/math/0e86afd07eb8be7351058918c6ecae8e9d6eccb9.png" alt="2R"/>.  The normalizaion of <img class="math" src="../_images/math/addf6166115ffd93feb8be6dc7a575e5e6131611.png" alt="\tilde\chi(R)"/> from a Fourier
transform of <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> is a matter of convention, but we follow the
symmetric case above (with <img class="math" src="../_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/> replaced by <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> and
<img class="math" src="../_images/math/54d7d48553f4d9e7ab418118607ea324cbfddfda.png" alt="\omega"/> replaced by <img class="math" src="../_images/math/0e86afd07eb8be7351058918c6ecae8e9d6eccb9.png" alt="2R"/>, and of course <img class="math" src="../_images/math/bb2c93730dbb48558bb3c4738c956c4e8f816437.png" alt="f"/> by
<img class="math" src="../_images/math/6dcb9b88aaa5f14312835145edf06fb2d0823c29.png" alt="\chi"/>).</p>
<p>But there are two more important issues to mention.  First, an XAFS Fourier
transform mutiplies <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> by a power of <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>, <img class="math" src="../_images/math/67c554dfde776faf84eee88fb710170179f1b5a4.png" alt="k^n"/>
and by a window function <img class="math" src="../_images/math/96353c36e52c43ad8175ee469239c4e6fcbe8230.png" alt="\Omega(k)"/> before doing the Fourier
transform.  The power-law weighting allow the oscillations in <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> to
emphasize different portions of the spectra, or to give a uniform intensity
to the oscillations.  The window function acts to smooth the resulting
Fourier transform and remove ripple and ringing in it that would result
from a sudden truncation of <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/>  at the end of the data range.</p>
<p>The second important issue is that the continuous Fourier transform
described above is replaced by a discrete transform.</p>
</div>
<div class="section" id="fourier-transform-windows">
<h2>Fourier transform windows<a class="headerlink" href="#fourier-transform-windows" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ftwindow">
<tt class="descname">ftwindow</tt><big>(</big><em>k</em>, <em>xmin=0</em>, <em>xmax=None</em>, <em>dk=1</em>, <em>...</em><big>)</big><a class="headerlink" href="#ftwindow" title="Permalink to this definition">¶</a></dt>
<dd><p>create a Fourier transform window function.</p>
</dd></dl>

</div>
<div class="section" id="forward-xafs-fourier-transforms">
<h2>Forward XAFS Fourier transforms (<img class="math" src="../_images/math/74a778df2be28afb0293f1bd3948fe7da53cf082.png" alt="k{\rightarrow}R"/>)<a class="headerlink" href="#forward-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>The forward Fourier transform converts <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> to <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/>
and is of primary importance for XAFS analysis.  In Larch, this is
encapsulated in the <a class="reference internal" href="#xafsft" title="xafsft"><tt class="xref py py-func docutils literal"><span class="pre">xafsft()</span></tt></a> function.</p>
<dl class="function">
<dt id="xafsft">
<tt class="descname">xafsft</tt><big>(</big><em>k</em>, <em>chi</em>, <em>group=None</em>, <em>...</em><big>)</big><a class="headerlink" href="#xafsft" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a forward XAFS Fourier transform, from <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> to
<img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/>, using common XAFS conventions.</p>
</dd></dl>

<dl class="function">
<dt id="xafsft_fast">
<tt class="descname">xafsft_fast</tt><big>(</big><em>chi</em>, <em>nfft=2048</em>, <em>kstep=0.05</em><big>)</big><a class="headerlink" href="#xafsft_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a forward XAFS Fourier transform, from <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> to
<img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/>, using common XAFS conventions.  This version demands
chi to represent <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> on a uniform <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> grid, and
returns the complex array of <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> without putting any
values into a group.</p>
</dd></dl>

</div>
<div class="section" id="inverse-xafs-fourier-transforms">
<h2>Inverse XAFS Fourier transforms (<img class="math" src="../_images/math/355651533ada75aa6ca33a45d111bf5553d4301c.png" alt="R{\rightarrow}q"/>)<a class="headerlink" href="#inverse-xafs-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<p>Inverse Fourier transforms convert <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> back to filtered
<img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/>.  We refer to the filtered <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> space as <img class="math" src="../_images/math/0615acc3725de21025457e7d6f7694dab8e2f758.png" alt="q"/> to
emphasize the distinction between the two.</p>
<dl class="function">
<dt id="xafsift">
<tt class="descname">xafsift</tt><big>(</big><em>r</em>, <em>chir</em>, <em>group=None</em>, <em>...</em><big>)</big><a class="headerlink" href="#xafsift" title="Permalink to this definition">¶</a></dt>
<dd><p>perform an inverse XAFS Fourier transform, from <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> to
<img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/>, using common XAFS conventions.</p>
</dd></dl>

<dl class="function">
<dt id="xafsift_fast">
<tt class="descname">xafsift_fast</tt><big>(</big><em>chi</em>, <em>nfft=2048</em>, <em>kstep=0.05</em><big>)</big><a class="headerlink" href="#xafsift_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>perform a reverse XAFS Fourier transform, from <img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> to
<img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/>, using common XAFS conventions.  This version demands
chir to represent the complex <img class="math" src="../_images/math/ed15c000bb99f0b4fabad9eb23e2d7089bc35895.png" alt="\chi(R)"/> as created from
<img class="math" src="../_images/math/bb12e6fe6361a7e793c32820d5b6f2d83e1511d2.png" alt="\chi(k)"/> on a uniform <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> grid, and returns the complex
array of <img class="math" src="../_images/math/cbc9515317140e14d0f369a98cb3a53cc2c3dd02.png" alt="\chi(q)"/> without putting any values into a group.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="feffit.html" title="XAFS: Fitting XAFS to Feff Paths"
             >next</a> |</li>
        <li class="right" >
          <a href="autobk.html" title="XAFS: Post-edge Background Subtraction"
             >previous</a> |</li>
   <li><a href="../installation.html">download</a>|&nbsp;</li>
   <li><a href="../contents.html">contents</a>|&nbsp;</li>
   <li><a href="../tutorial/index.html">tutorial</a>|&nbsp;</li>
   <li><a href="index.html">XAFS analysis</a>|&nbsp;</li>
   <li><a href="../xray/index.html">XRF analysis</a>|&nbsp;</li>
   &nbsp;&nbsp;<li><a href="../search.html">search</a>&nbsp;</li>

          <li><a href="index.html" >XAFS Analysis with Larch</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Matthew Newville.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>