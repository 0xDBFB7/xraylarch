

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>11.1. XAFS Functions: Overview and Naming Conventions &#8212; larch 0.9.44 documentation</title>
    <link rel="stylesheet" href="../_static/larchdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11.2. XAFS: Pre-edge Subtraction, Normalization, and data treatment" href="preedge.html" />
    <link rel="prev" title="11. XAFS Analysis" href="index.html" />
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({ "TeX": {Macros: {AA : "{\\unicode{x212B}}"}},
			 "HTML-CSS": {scale: 90}});
  </script>

  </head><body>
<div style=" color: #c5daba;  text-align: left; height:65px; padding: 0px">
<table border=1>
  <tr>
    <td width=20%>
	<a href="../index.html">
	 <img src="../_static/larchcones.png" height=60px alt="larchcones"/></a>
    </td>
    <td width=75% padding=0>
      <font size=+2>
	<a href="../index.html" style="color:#772211">
	  Larch: Data Analysis Tools for X-ray Spectroscopy
	</a>
      </font>
    </td>
   </tr></table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="preedge.html" title="11.2. XAFS: Pre-edge Subtraction, Normalization, and data treatment"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="11. XAFS Analysis"
             accesskey="P">previous</a> |</li>
   <li>[<a href="../index.html"> Larch</a>|</li>
   <li><a href="../getting_started.html"> Getting Started</a>|</li>
   <li><a href="index.html">XAFS Analysis</a>|</li>
   <li><a href="../xray/index.html">X-ray Databases</a>|</li>
   <li><a href="../xrf/index.html">XRF Analysis</a>|</li>
   <li><a href="../fitting/index.html">Curve Fitting</a>|</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">11. XAFS Analysis</a> &#187;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">11.1. XAFS Functions: Overview and Naming Conventions</a><ul>
<li><a class="reference internal" href="#naming-conventions-for-xafs-arrays">11.1.1. Naming conventions for XAFS arrays</a><ul>
<li><a class="reference internal" href="#group-argument-and-sys-xafsgroup">11.1.1.1. <cite>group</cite> argument and <code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code></a></li>
<li><a class="reference internal" href="#first-argument-group-convention">11.1.1.2. First Argument Group convention</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plotting-macros-for-xafs">11.1.2. Plotting Macros for XAFS</a><ul>
<li><a class="reference internal" href="#plot-mu">11.1.2.1. <code class="docutils literal notranslate"><span class="pre">plot_mu()</span></code></a></li>
<li><a class="reference internal" href="#plot-bkg">11.1.2.2. <code class="docutils literal notranslate"><span class="pre">plot_bkg()</span></code></a></li>
<li><a class="reference internal" href="#plot-chik">11.1.2.3. <code class="docutils literal notranslate"><span class="pre">plot_chik()</span></code></a></li>
<li><a class="reference internal" href="#plot-chir">11.1.2.4. <code class="docutils literal notranslate"><span class="pre">plot_chir()</span></code></a></li>
<li><a class="reference internal" href="#plot-chifit">11.1.2.5. <code class="docutils literal notranslate"><span class="pre">plot_chifit()</span></code></a></li>
<li><a class="reference internal" href="#plot-path-k">11.1.2.6. <code class="docutils literal notranslate"><span class="pre">plot_path_k()</span></code></a></li>
<li><a class="reference internal" href="#plot-path-r">11.1.2.7. <code class="docutils literal notranslate"><span class="pre">plot_path_r()</span></code></a></li>
<li><a class="reference internal" href="#plot-paths-k">11.1.2.8. <code class="docutils literal notranslate"><span class="pre">plot_paths_k()</span></code></a></li>
<li><a class="reference internal" href="#plot-paths-r">11.1.2.9. <code class="docutils literal notranslate"><span class="pre">plot_paths_r()</span></code></a></li>
<li><a class="reference internal" href="#plot-prepeaks-baseline">11.1.2.10. <code class="docutils literal notranslate"><span class="pre">plot_prepeaks_baseline()</span></code></a></li>
<li><a class="reference internal" href="#plot-prepeaks-fit">11.1.2.11. <code class="docutils literal notranslate"><span class="pre">plot_prepeaks_fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#utility-functions-for-xafs">11.1.3. Utility Functions for XAFS</a><ul>
<li><a class="reference internal" href="#ktoe-and-etok">11.1.3.1. <code class="docutils literal notranslate"><span class="pre">ktoe()</span></code> and <code class="docutils literal notranslate"><span class="pre">etok()</span></code></a></li>
<li><a class="reference internal" href="#estimate-noise">11.1.3.2. <code class="docutils literal notranslate"><span class="pre">estimate_noise()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">11. XAFS Analysis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="preedge.html"
                        title="next chapter">11.2. XAFS: Pre-edge Subtraction, Normalization, and data treatment</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/xafs/utilities.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-_xafs">
<span id="xafs-functions-overview-and-naming-conventions"></span><h1>11.1. XAFS Functions: Overview and Naming Conventions<a class="headerlink" href="#module-_xafs" title="Permalink to this headline">¶</a></h1>
<p>As with most Larch functions, each of the XAFS functions is designed to be
able to act on arbitrary arrays of data to allow maximum flexibility in
processing data.  In addition, many of the Larch XAFS functions can write
out several output values, including both scalaras and arrays.  While
flexible, this could get rather cumbersome, and mean that you would
generally have to keep track of a large set of related arrays.</p>
<div class="section" id="naming-conventions-for-xafs-arrays">
<h2>11.1.1. Naming conventions for XAFS arrays<a class="headerlink" href="#naming-conventions-for-xafs-arrays" title="Permalink to this headline">¶</a></h2>
<p>In Larch, it is most natural to put related data into a Group.  This is
often natural as data read in from a file is already held in a Group.  If a
set of XAFS data is held within a Group, then the Group members named
<cite>energy</cite> and <cite>k</cite> and <cite>chi</cite> can be assumed to have the same standard meaning
for all groups of XAFS Data.  To make this most common usage easy, all of
the XAFS functions follow a couple conventions for working more easily with
Groups tht can work on arbitrary arrays of data, but assume that they will
write output values to a Group.  In addition, the XAFS functions can
usually just be given a Group that follows the expected XAFS naming
convention.  This is not rigidly enforced, and is not exclusive (that is,
you can add data with other names), but following the expected naming
conventions will make processing XAFS data much easier.</p>
<p>The naming convention define a set of <strong>expected names and meaning</strong> for
data arrays and scalars within a Group.  This is summarized in the
<a class="reference internal" href="#xafsnames-table"><span class="std std-ref">Table of Conventional Names for an XAFS Group</span></a> below.</p>
<p id="xafsnames-table"><strong>Table of Conventional Names for an XAFS Group</strong> These are the standard names for arrays and
scalars for various data associated with XAFS, including FEFF calculations.  Given are the name,
the physical quantity described, and the name of function that will generate this value.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="9%" />
<col width="33%" />
<col width="41%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">type</th>
<th class="head">meaning</th>
<th class="head">created by</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>energy</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(E\)</span> in eV</td>
<td>original data</td>
</tr>
<tr class="row-odd"><td>mu</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\mu\)</span></td>
<td>original data</td>
</tr>
<tr class="row-even"><td>e0</td>
<td>scalar</td>
<td><span class="math notranslate nohighlight">\(E_0\)</span></td>
<td><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a>, <a class="reference internal" href="preedge.html#find_e0" title="find_e0"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_e0()</span></code></a></td>
</tr>
<tr class="row-odd"><td>edge_step</td>
<td>scalar</td>
<td><span class="math notranslate nohighlight">\(\Delta \mu\)</span></td>
<td><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></td>
</tr>
<tr class="row-even"><td>dmude</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(d\mu/dE\)</span></td>
<td><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></td>
</tr>
<tr class="row-odd"><td>norm</td>
<td>array</td>
<td>normalized <span class="math notranslate nohighlight">\(\mu\)</span></td>
<td><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></td>
</tr>
<tr class="row-even"><td>flat</td>
<td>array</td>
<td>flattened <span class="math notranslate nohighlight">\(\mu\)</span></td>
<td><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></td>
</tr>
<tr class="row-odd"><td>pre_edge</td>
<td>array</td>
<td>pre-edge curve</td>
<td><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></td>
</tr>
<tr class="row-even"><td>post_edge</td>
<td>array</td>
<td>normalization curve</td>
<td><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></td>
</tr>
<tr class="row-odd"><td>bkg</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\mu_0(E)\)</span></td>
<td><a class="reference internal" href="autobk.html#_xafs.autobk" title="_xafs.autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a></td>
</tr>
<tr class="row-even"><td>chie</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\chi(E)\)</span></td>
<td><a class="reference internal" href="autobk.html#_xafs.autobk" title="_xafs.autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a></td>
</tr>
<tr class="row-odd"><td>k</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(k\)</span></td>
<td><a class="reference internal" href="autobk.html#_xafs.autobk" title="_xafs.autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a></td>
</tr>
<tr class="row-even"><td>chi</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\chi(k)\)</span></td>
<td><a class="reference internal" href="autobk.html#_xafs.autobk" title="_xafs.autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a></td>
</tr>
<tr class="row-odd"><td>kwin</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\Omega(k)\)</span></td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a>, <a class="reference internal" href="xafsft.html#_xafs.ftwindow" title="_xafs.ftwindow"><code class="xref py py-func docutils literal notranslate"><span class="pre">ftwindow()</span></code></a></td>
</tr>
<tr class="row-even"><td>r</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(R\)</span></td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a></td>
</tr>
<tr class="row-odd"><td>chir</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\chi(R)\)</span> (complex)</td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a></td>
</tr>
<tr class="row-even"><td>chir_mag</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(|\chi(R)|\)</span></td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a></td>
</tr>
<tr class="row-odd"><td>chir_re</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\rm Re[\chi(R)]\)</span></td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a></td>
</tr>
<tr class="row-even"><td>chir_im</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\rm Im[\chi(R)]\)</span></td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a></td>
</tr>
<tr class="row-odd"><td>rwin</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\Omega(R)\)</span></td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftr" title="_xafs.xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></td>
</tr>
<tr class="row-even"><td>q</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(q\)</span></td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftr" title="_xafs.xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></td>
</tr>
<tr class="row-odd"><td>chiq</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\chi(q)\)</span> (complex)</td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftr" title="_xafs.xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></td>
</tr>
<tr class="row-even"><td>chiq_mag</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(|\chi(q)|\)</span></td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftr" title="_xafs.xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></td>
</tr>
<tr class="row-odd"><td>chiq_re</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\rm Re[\chi(q)]\)</span></td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftr" title="_xafs.xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></td>
</tr>
<tr class="row-even"><td>chiq_im</td>
<td>array</td>
<td><span class="math notranslate nohighlight">\(\rm Im[\chi(q)]\)</span></td>
<td><a class="reference internal" href="xafsft.html#_xafs.xftr" title="_xafs.xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(q\)</span>, <span class="math notranslate nohighlight">\(\chi(q)\)</span>, and so on indicates back-transformed <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>The XAFS functions encourage following this convention, in that they are consistent in wanting
<span class="math notranslate nohighlight">\(\chi(k)\)</span> to be represented by the two arrays <code class="docutils literal notranslate"><span class="pre">GROUP.k</span></code> and <code class="docutils literal notranslate"><span class="pre">GROUP.chi</span></code></p>
<div class="section" id="group-argument-and-sys-xafsgroup">
<h3>11.1.1.1. <cite>group</cite> argument and <code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code><a class="headerlink" href="#group-argument-and-sys-xafsgroup" title="Permalink to this headline">¶</a></h3>
<p>The XAFS functions need to write outputs to some group – there are simply too many outputs to
return and expect you to manage.   So, all functions take a <strong>group</strong> argument, which is used
as the group into which results are written.  Again, this allows maximum flexibility, but gets
tedious to provide this argument repeatedly when working with a particular data set.</p>
<p>There is also a special group, <code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code> that is used as the default group to write
outputs to if no <strong>group</strong> argument is supplied.  When an an explicit <strong>group</strong> argument is given,
<code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code> is set to this group.  This means that when working with a set of XAFS data all
contained within a single group (which is expected to be the normal case), the <strong>group</strong> argument
does not need to be typed repeatedly.</p>
</div>
<div class="section" id="first-argument-group-convention">
<span id="first-argument-group"></span><span id="index-0"></span><h3>11.1.1.2. First Argument Group convention<a class="headerlink" href="#first-argument-group-convention" title="Permalink to this headline">¶</a></h3>
<p>This convention gives a simple approach when working with data Groups
follow the XAFS naming conventions.  It is built on the <code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code>
convention above but is even easier to use.  That is, while the XAFS
functions can take arrays of data as the first two arguments, they also
allow the first argument to be a Group, as long as it has the expected
named arrays.  This convention is called the <strong>First
Argument Group</strong> convention, and is worth understanding and using because
all the XAFS functions in Larch follow it.</p>
<p>As an example, the most general use of the <a class="reference internal" href="autobk.html#_xafs.autobk" title="_xafs.autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a> function would
mean giving an array of energy as the first argument, an array of mu as the
second argument, and supplyng an output group for placing all the arrays
and data calculated within the function.  That is, the most general use
would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">autobk</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat</span><span class="p">,</span> <span class="n">rbkg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">....</span><span class="p">)</span>
</pre></div>
</div>
<p>but most usage will actually want to use <cite>energy</cite> and <cite>mu</cite> arrays from the
same group, and use that group as the output group, so that all data stays
contained within the same group.  Following the most general case, that
would mean the call would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">autobk</span><span class="p">(</span><span class="n">dat</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">dat</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat</span><span class="p">,</span> <span class="n">rbkg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">....</span><span class="p">)</span>
</pre></div>
</div>
<p>The First argument convention allows this to be abbreviated as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">autobk</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">rbkg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">....</span><span class="p">)</span>
</pre></div>
</div>
<p>That is, as long as the Group <cite>dat</cite> follows the XAFS naming conventions
(for <a class="reference internal" href="autobk.html#_xafs.autobk" title="_xafs.autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a> that it has an energy array named <cite>energy</cite> and
absorbance array named <cite>mu</cite>) the two forms above are equivalent.  All the
XAFS functions follow this convention and use a consistent set of attribute
names (see <a class="reference internal" href="#xafsnames-table"><span class="std std-ref">Table of Conventional Names for an XAFS Group</span></a>).  This convention nearly makes the Larch XAFS routines
into object-oriented, or in this case <strong>Group oriented</strong>, set of functions
that interact in a coherent and predictable way on an XAFS dataset.</p>
</div>
</div>
<div class="section" id="plotting-macros-for-xafs">
<h2>11.1.2. Plotting Macros for XAFS<a class="headerlink" href="#plotting-macros-for-xafs" title="Permalink to this headline">¶</a></h2>
<p>XAFS analysis often uses several different standard views of the data arrays
for <span class="math notranslate nohighlight">\(\mu(E)\)</span>, <span class="math notranslate nohighlight">\(\chi(k)\)</span>, and <span class="math notranslate nohighlight">\(\chi(R)\)</span>.  Larch’s plotting
capabilities provide wide flexibility in how plots can be done.  While that
flexibility can be useful in general, within the narrow scope of plotting
XAFS data, being able to easily create consistent plots with reasonable
defaults produces results that are easier to digest and understand.</p>
<p>The macros described here attempt to provide that functionality of
easy-to-use standard plotting macros. In particular, they automatically
handle typesetting the labels for the plot axes in a consistent manner, and
assign consistent labels to the different curves shown.  The results are also
easily extended, so that you can add curves, annotations, etc.  Many of the
examples in the following sections in this chapter make use of these macros.</p>
<div class="section" id="plot-mu">
<h3>11.1.2.1. <a class="reference internal" href="#_xafs.plot_mu" title="_xafs.plot_mu"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_mu()</span></code></a><a class="headerlink" href="#plot-mu" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_xafs.plot_mu">
<code class="descclassname">_xafs.</code><code class="descname">plot_mu</code><span class="sig-paren">(</span><em>dgroup</em>, <em>norm=False</em>, <em>deriv=False</em>, <em>show_pre=False</em>, <em>show_post=False</em>, <em>show_e0=False</em>, <em>emin=None</em>, <em>emax=None</em>, <em>label=None</em>, <em>new=True</em>, <em>win=1</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.plot_mu" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Plot <span class="math notranslate nohighlight">\(\mu(E)\)</span> for an XAFS data group in various forms</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dgroup</strong> – group of XAFS data after <a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a> results (see note below)</li>
<li><strong>norm</strong> – bool whether to show normalized data [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>deriv</strong> – bool whether to show derivative of XAFS data [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>show_pre</strong> – bool whether to show pre-edge curve [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>show_post</strong> – bool whether to show post-edge curve [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>show_e0</strong> – bool whether to show E0 [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>show_deriv</strong> – bool whether to show deriv together with mu [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>emin</strong> – min energy to show, relative to E0 [<code class="docutils literal notranslate"><span class="pre">None</span></code>, start of data]</li>
<li><strong>emax</strong> – max energy to show, relative to E0 [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</li>
<li><strong>label</strong> – string for label [<code class="docutils literal notranslate"><span class="pre">None</span></code>:  ‘mu’, ‘dmu/dE’, or ‘mu norm’]</li>
<li><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The input data group must have the following attributes: <cite>energy</cite>, <cite>mu</cite>,
<cite>norm</cite>, <cite>e0</cite>, <cite>pre_edge</cite>, <cite>edge_step</cite>, <cite>filename</cite></p>
</dd></dl>

</div>
<div class="section" id="plot-bkg">
<h3>11.1.2.2. <a class="reference internal" href="#_xafs.plot_bkg" title="_xafs.plot_bkg"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_bkg()</span></code></a><a class="headerlink" href="#plot-bkg" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_xafs.plot_bkg">
<code class="descclassname">_xafs.</code><code class="descname">plot_bkg</code><span class="sig-paren">(</span><em>dgroup</em>, <em>norm=True</em>, <em>emin=None</em>, <em>emax=None</em>, <em>show_e0=False</em>, <em>label=None</em>, <em>new=True</em>, <em>win=1</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.plot_bkg" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <span class="math notranslate nohighlight">\(\mu(E)\)</span> and background <span class="math notranslate nohighlight">\(\mu_0(E)\)</span> for XAFS data group</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dgroup</strong> – group of XAFS data after autobk() results (see note below)</li>
<li><strong>norm</strong> – bool whether to show normalized data [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>emin</strong> – min energy to show, relative to <span class="math notranslate nohighlight">\(E_0\)</span> [<code class="docutils literal notranslate"><span class="pre">None</span></code>, start of data]</li>
<li><strong>emax</strong> – max energy to show, relative to <span class="math notranslate nohighlight">\(E_0\)</span> [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</li>
<li><strong>show_e0</strong> – bool whether to show E0 [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>label</strong> – string for label [<code class="docutils literal notranslate"><span class="pre">None</span></code>:  ‘mu’]</li>
<li><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The input data group must have the following attributes: <cite>energy</cite>, <cite>mu</cite>,
<cite>bkg</cite>, <cite>norm</cite>, <cite>e0</cite>, <cite>pre_edge</cite>, <cite>edge_step</cite>, <cite>filename</cite></p>
</dd></dl>

</div>
<div class="section" id="plot-chik">
<h3>11.1.2.3. <a class="reference internal" href="#_xafs.plot_chik" title="_xafs.plot_chik"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_chik()</span></code></a><a class="headerlink" href="#plot-chik" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_xafs.plot_chik">
<code class="descclassname">_xafs.</code><code class="descname">plot_chik</code><span class="sig-paren">(</span><em>dgroup</em>, <em>kweight=None</em>, <em>kmax=None</em>, <em>show_window=True</em>, <em>label=None</em>, <em>new=True</em>, <em>win=1</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.plot_chik" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot k-weighted <span class="math notranslate nohighlight">\(\chi(k)\)</span> for XAFS data group</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dgroup</strong> – group of XAFS data after autobk() results (see note below)</li>
<li><strong>kweight</strong> – k-weighting for plot [read from last <a class="reference internal" href="xafsft.html#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a>, or 0]</li>
<li><strong>kmax</strong> – max k to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</li>
<li><strong>show_window</strong> – bool whether to also plot k-window [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>label</strong> – string for label [<code class="docutils literal notranslate"><span class="pre">None</span></code>:  ‘chi’]</li>
<li><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The input data group must have the following attributes: <cite>k</cite>, <cite>chi</cite>,
<cite>kwin</cite>, <cite>filename</cite>.</p>
</dd></dl>

</div>
<div class="section" id="plot-chir">
<h3>11.1.2.4. <a class="reference internal" href="#_xafs.plot_chir" title="_xafs.plot_chir"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_chir()</span></code></a><a class="headerlink" href="#plot-chir" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_xafs.plot_chir">
<code class="descclassname">_xafs.</code><code class="descname">plot_chir</code><span class="sig-paren">(</span><em>dgroup</em>, <em>show_mag=True</em>, <em>show_real=False</em>, <em>show_imag=False</em>, <em>rmax=None</em>, <em>label=True</em>, <em>new=True</em>, <em>win=1</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.plot_chir" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <span class="math notranslate nohighlight">\(\chi(R)\)</span> for XAFS data group</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dgroup</strong> – group of XAFS data after xftf() results (see note below)</li>
<li><strong>show_mag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(|\chi(R)|\)</span> [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>show_real</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Re[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>show_imag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Im[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>rmax</strong> – max R to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</li>
<li><strong>label</strong> – string for label [<code class="docutils literal notranslate"><span class="pre">None</span></code>:  ‘chir’]</li>
<li><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The input data group must have the following attributes: <cite>r</cite>,
<cite>chir_mag</cite>, <cite>chir_im</cite>, <cite>chir_re</cite>, <cite>kweight</cite>, <cite>filename</cite></p>
</dd></dl>

</div>
<div class="section" id="plot-chifit">
<h3>11.1.2.5. <a class="reference internal" href="#_xafs.plot_chifit" title="_xafs.plot_chifit"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_chifit()</span></code></a><a class="headerlink" href="#plot-chifit" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_xafs.plot_chifit">
<code class="descclassname">_xafs.</code><code class="descname">plot_chifit</code><span class="sig-paren">(</span><em>dataset</em>, <em>kmin=0</em>, <em>kmax=None</em>, <em>rmax=None</em>, <em>show_mag=True</em>, <em>show_real=False</em>, <em>show_imag=False</em>, <em>new=True</em>, <em>win=1</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.plot_chifit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot k-weighted <span class="math notranslate nohighlight">\(\chi(k)\)</span> and <span class="math notranslate nohighlight">\(\chi(R)\)</span> for fit to feffit dataset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset</strong> – feffit dataset, after running <a class="reference internal" href="feffit.html#_xafs.feffit" title="_xafs.feffit"><code class="xref py py-func docutils literal notranslate"><span class="pre">feffit()</span></code></a>.</li>
<li><strong>kmin</strong> – min k to show [0]</li>
<li><strong>kmax</strong> – max k to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</li>
<li><strong>rmax</strong> – max R to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</li>
<li><strong>show_mag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(|chi(R)|\)</span> [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>show_real</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Re[\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>show_imag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Im[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="plot-path-k">
<h3>11.1.2.6. <a class="reference internal" href="#_xafs.plot_path_k" title="_xafs.plot_path_k"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_path_k()</span></code></a><a class="headerlink" href="#plot-path-k" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_xafs.plot_path_k">
<code class="descclassname">_xafs.</code><code class="descname">plot_path_k</code><span class="sig-paren">(</span><em>dataset</em>, <em>ipath</em>, <em>kmin=0</em>, <em>kmax=None</em>, <em>offset=0</em>, <em>label=None</em>, <em>new=False</em>, <em>win=1</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.plot_path_k" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot k-weighted <span class="math notranslate nohighlight">\(\chi(k)\)</span> for a single Path of a feffit dataset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset</strong> – feffit dataset, after running <a class="reference internal" href="feffit.html#_xafs.feffit" title="_xafs.feffit"><code class="xref py py-func docutils literal notranslate"><span class="pre">feffit()</span></code></a></li>
<li><strong>ipath</strong> – index of path, starting count at 0 [0]</li>
<li><strong>kmin</strong> – min k to show [0]</li>
<li><strong>kmax</strong> – max k to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</li>
<li><strong>offset</strong> – vertical offset to use for plot [0]</li>
<li><strong>label</strong> – path label [‘path I’]</li>
<li><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
<li><strong>kws</strong> – additional keyword arguments are passed to plot()</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="plot-path-r">
<h3>11.1.2.7. <a class="reference internal" href="#_xafs.plot_path_r" title="_xafs.plot_path_r"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_path_r()</span></code></a><a class="headerlink" href="#plot-path-r" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_xafs.plot_path_r">
<code class="descclassname">_xafs.</code><code class="descname">plot_path_r</code><span class="sig-paren">(</span><em>dataset</em>, <em>ipath</em>, <em>rmax=None</em>, <em>offset=0</em>, <em>label=None</em>, <em>show_mag=True</em>, <em>show_real=False</em>, <em>show_imag=True</em>, <em>new=False</em>, <em>win=1</em>, <em>**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.plot_path_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <span class="math notranslate nohighlight">\(\chi(R)\)</span> for a single Path of a feffit dataset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset</strong> – feffit dataset, after running <a class="reference internal" href="feffit.html#_xafs.feffit" title="_xafs.feffit"><code class="xref py py-func docutils literal notranslate"><span class="pre">feffit()</span></code></a></li>
<li><strong>ipath</strong> – index of path, starting count at 0 [0]</li>
<li><strong>kmax</strong> – max k to show [None, end of data]</li>
<li><strong>offset</strong> – vertical offset to use for plot [0]</li>
<li><strong>label</strong> – path label [‘path I’]</li>
<li><strong>show_mag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(|\chi(R)|\)</span> [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>show_real</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Re[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>show_imag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Im[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
<li><strong>kws</strong> – additional keyword arguments are passed to plot()</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="plot-paths-k">
<h3>11.1.2.8. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_paths_k()</span></code><a class="headerlink" href="#plot-paths-k" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
<code class="descname">plot_paths_k(dataset, offset=-1, kmin=0, kmax=None, new=True, win=1, **kws):</code></dt>
<dd><p>Plot k-weighted <cite>chi(k)</cite> for model and all paths of a feffit dataset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset</strong> – feffit dataset, after running <a class="reference internal" href="feffit.html#_xafs.feffit" title="_xafs.feffit"><code class="xref py py-func docutils literal notranslate"><span class="pre">feffit()</span></code></a></li>
<li><strong>kmin</strong> – min k to show [0]</li>
<li><strong>kmax</strong> – max k to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</li>
<li><strong>offset</strong> – vertical offset to use for paths for plot [-1]</li>
<li><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
<li><strong>kws</strong> – additional keyword arguments are passed to plot()</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="plot-paths-r">
<h3>11.1.2.9. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_paths_r()</span></code><a class="headerlink" href="#plot-paths-r" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
<code class="descname">plot_paths_r(dataset, offset=-0.5, rmax=None, show_mag=True, show_real=False, show_imag=False, new=True, win=1, **kws):</code></dt>
<dd><p>Plot <span class="math notranslate nohighlight">\(\chi(R)\)</span> for model and all paths of a feffit dataset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataset</strong> – feffit dataset, after running func:<cite>feffit</cite></li>
<li><strong>offset</strong> – vertical offset to use for paths for plot [-0.5]</li>
<li><strong>rmax</strong> – max R to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</li>
<li><strong>show_mag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(|\chi(R)|\)</span> [T``rue``]</li>
<li><strong>show_real</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Re[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>show_imag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Im[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
<li><strong>kws</strong> – additional keyword arguments are passed to plot()</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="plot-prepeaks-baseline">
<h3>11.1.2.10. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_prepeaks_baseline()</span></code><a class="headerlink" href="#plot-prepeaks-baseline" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
<code class="descname">plot_prepeaks_baseline(dgroup, subtract_baseline=False, show_fitrange=True, show_peakrange=True, win=1, **kws):</code></dt>
<dd><p>Plot pre-edge peaks and baseline fit, as from <a class="reference internal" href="preedge.html#pre_edge_baseline" title="pre_edge_baseline"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge_baseline()</span></code></a>
or XAS Viewer GUI</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dgroup</strong> – data group, after running <a class="reference internal" href="preedge.html#pre_edge_baseline" title="pre_edge_baseline"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge_baseline()</span></code></a></li>
<li><strong>subtract_baseline</strong> – bool whether to subtract baseline for plot</li>
<li><strong>show_fitrange</strong> – bool whether to show fit range as vertical bars</li>
<li><strong>show_peakrange</strong> – bool whether to show pre-edge peak range with markers</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
<li><strong>kws</strong> – additional keyword arguments are passed to plot()</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The <cite>dgroup</cite> group must have a <cite>prepeaks</cite> subgroup.</p>
</dd></dl>

</div>
<div class="section" id="plot-prepeaks-fit">
<h3>11.1.2.11. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_prepeaks_fit()</span></code><a class="headerlink" href="#plot-prepeaks-fit" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
<code class="descname">plot_prepeaks_fit(dgroup, show_init=False, subtract_baseline=False, show_residual=False, win=1, **kws):</code></dt>
<dd><p>Plot pre-edge peaks and fit, as XAS Viewer GUI</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dgroup</strong> – data group, after running pre-edge peak fit.</li>
<li><strong>show_init</strong> – bool whether to show initial model, before fitting</li>
<li><strong>subtract_baseline</strong> – bool whether to subtract baseline for plot</li>
<li><strong>show_residual</strong> – bool whether to show residual as a stacked plot.</li>
<li><strong>win</strong> – integer plot window to use [1]</li>
<li><strong>kws</strong> – additional keyword arguments are passed to plot()</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The <cite>dgroup</cite> group must have a <cite>peakfit_history</cite> subgroup. Currently,
this is automatically generated only using the XAS Viewer GUI or
scripts written (and possibly altered) by it.</p>
</dd></dl>

</div>
</div>
<div class="section" id="utility-functions-for-xafs">
<h2>11.1.3. Utility Functions for XAFS<a class="headerlink" href="#utility-functions-for-xafs" title="Permalink to this headline">¶</a></h2>
<p>Listed here are some general purpose functions for XAFS.</p>
<div class="section" id="ktoe-and-etok">
<h3>11.1.3.1. <a class="reference internal" href="#_xafs.ktoe" title="_xafs.ktoe"><code class="xref py py-func docutils literal notranslate"><span class="pre">ktoe()</span></code></a> and <a class="reference internal" href="#_xafs.etok" title="_xafs.etok"><code class="xref py py-func docutils literal notranslate"><span class="pre">etok()</span></code></a><a class="headerlink" href="#ktoe-and-etok" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_xafs.etok">
<code class="descclassname">_xafs.</code><code class="descname">etok</code><span class="sig-paren">(</span><em>energies</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.etok" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert photo-electron energy in eV to wavenumber in <span class="math notranslate nohighlight">\(\AA^{-1}\)</span>.
energies can be a single number or array of numbers.</p>
</dd></dl>

<dl class="function">
<dt id="_xafs.ktoe">
<code class="descclassname">_xafs.</code><code class="descname">ktoe</code><span class="sig-paren">(</span><em>wavenumbers</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.ktoe" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert photo-electron wavenumber in <span class="math notranslate nohighlight">\(\AA^{-1}\)</span> ot energy in eV.
wavenumber can be a single number or array of numbers.</p>
</dd></dl>

<p>An example use would be to print out a table of energies and <span class="math notranslate nohighlight">\(k\)</span> values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="n">kvals</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">larch</span><span class="o">&gt;</span> <span class="n">evals</span> <span class="o">=</span> <span class="n">ktoe</span><span class="p">(</span><span class="n">kvals</span><span class="p">)</span>
<span class="n">larch</span><span class="o">&gt;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">kvals</span><span class="p">,</span> <span class="n">evals</span><span class="p">)):</span>
<span class="n">larch</span><span class="o">&gt;</span>      <span class="nb">print</span> <span class="s2">&quot; </span><span class="si">%5.1f</span><span class="s2"> 1/Ang -&gt;  </span><span class="si">%8.2f</span><span class="s2"> eV&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">k</span> <span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="n">larch</span><span class="o">&gt;</span> <span class="n">endfor</span>
   <span class="mf">0.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>      <span class="mf">0.00</span> <span class="n">eV</span>
   <span class="mf">1.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>      <span class="mf">3.81</span> <span class="n">eV</span>
   <span class="mf">2.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>     <span class="mf">15.24</span> <span class="n">eV</span>
   <span class="mf">3.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>     <span class="mf">34.29</span> <span class="n">eV</span>
   <span class="mf">4.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>     <span class="mf">60.96</span> <span class="n">eV</span>
   <span class="mf">5.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>     <span class="mf">95.25</span> <span class="n">eV</span>
   <span class="mf">6.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">137.16</span> <span class="n">eV</span>
   <span class="mf">7.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">186.69</span> <span class="n">eV</span>
   <span class="mf">8.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">243.84</span> <span class="n">eV</span>
   <span class="mf">9.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">308.61</span> <span class="n">eV</span>
  <span class="mf">10.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">381.00</span> <span class="n">eV</span>
  <span class="mf">11.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">461.01</span> <span class="n">eV</span>
  <span class="mf">12.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">548.64</span> <span class="n">eV</span>
  <span class="mf">13.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">643.89</span> <span class="n">eV</span>
  <span class="mf">14.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">746.76</span> <span class="n">eV</span>
  <span class="mf">15.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">857.25</span> <span class="n">eV</span>
  <span class="mf">16.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">975.36</span> <span class="n">eV</span>
  <span class="mf">17.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1101.08</span> <span class="n">eV</span>
  <span class="mf">18.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1234.43</span> <span class="n">eV</span>
  <span class="mf">19.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1375.40</span> <span class="n">eV</span>
  <span class="mf">20.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1523.99</span> <span class="n">eV</span>
  <span class="mf">21.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1680.20</span> <span class="n">eV</span>
  <span class="mf">22.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1844.03</span> <span class="n">eV</span>
  <span class="mf">23.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">2015.48</span> <span class="n">eV</span>
  <span class="mf">24.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">2194.55</span> <span class="n">eV</span>
  <span class="mf">25.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">2381.24</span> <span class="n">eV</span>
</pre></div>
</div>
</div>
<div class="section" id="estimate-noise">
<h3>11.1.3.2. <a class="reference internal" href="#_xafs.estimate_noise" title="_xafs.estimate_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">estimate_noise()</span></code></a><a class="headerlink" href="#estimate-noise" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="_xafs.estimate_noise">
<code class="descclassname">_xafs.</code><code class="descname">estimate_noise</code><span class="sig-paren">(</span><em>k</em>, <em>chi=None</em>, <em>group=None</em>, <em>rmin=15</em>, <em>rmax=30</em>, <em>....</em><span class="sig-paren">)</span><a class="headerlink" href="#_xafs.estimate_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically estimate the noise level in a <span class="math notranslate nohighlight">\(\chi(k)\)</span> spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>k</strong> – 1-d array of <span class="math notranslate nohighlight">\(k\)</span></li>
<li><strong>chi</strong> – 1-d array of <span class="math notranslate nohighlight">\(\chi\)</span></li>
<li><strong>group</strong> – output group.</li>
<li><strong>rmin</strong> – minimum <span class="math notranslate nohighlight">\(R\)</span> value for noise estimate.</li>
<li><strong>rmax</strong> – maximum <span class="math notranslate nohighlight">\(R\)</span> value for noise estimate.</li>
<li><strong>kweight</strong> – exponent for weighting spectra by k**kweight [1]</li>
<li><strong>kmin</strong> – starting k for FT Window [0]</li>
<li><strong>kmax</strong> – ending k for FT Window  [20]</li>
<li><strong>dk</strong> – tapering parameter for FT Window [4]</li>
<li><strong>dk2</strong> – second tapering parameter for FT Window [None]</li>
<li><strong>window</strong> – name of window type [‘kaiser’]</li>
<li><strong>nfft</strong> – value to use for N_fft [2048].</li>
<li><strong>kstep</strong> – value to use for delta_k ( Ang^-1) [0.05]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The method uses an XAFS Fourier transform, and many of arguments
(<strong>kmin</strong>, <strong>kmax</strong>, etc) are identical to those of <a class="reference internal" href="xafsft.html#_xafs.xftf" title="_xafs.xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a>.</p>
<p>This function follows the First Argument Group convention with arrarys named <cite>k</cite> and <cite>chi</cite>.
The following outputs are written to the supplied <strong>group</strong> (or <cite>_sys.xafsGroup</cite> if
<strong>group</strong> is not supplied):</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>epsilon_k</td>
<td>estimated noise level in <span class="math notranslate nohighlight">\(\chi(k)\)</span>.</td>
</tr>
<tr class="row-odd"><td>epsilon_r</td>
<td>estimated noise level in <span class="math notranslate nohighlight">\(\chi(R)\)</span>.</td>
</tr>
<tr class="row-even"><td>kmax_suggest</td>
<td>suggested highest <span class="math notranslate nohighlight">\(k\)</span> value for which <span class="math notranslate nohighlight">\(|\chi(k)| &gt; \epsilon_k\)</span></td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd></dl>

<p>This method uses the high-R portion of <span class="math notranslate nohighlight">\(\chi(R)\)</span> (between <strong>rmin</strong>
and <strong>rmax</strong>) as a measure of the noise level in the <span class="math notranslate nohighlight">\(\chi(R)\)</span> data
and uses Parseval’s theorem to convert this noise level to that in
<span class="math notranslate nohighlight">\(\chi(k)\)</span>.  This method implicitly assumes that there is no signal in
the high-R portion of the spectrum, and that the noise in the spectrum is
“white” (independent of <span class="math notranslate nohighlight">\(R\)</span>) .  Each of these assumptions can be
legitimately questioned.  Then again, making the assertion that these
assumptions are invalid and disregarding the estimated noise level here
would require knowledge of the noise in an XAFS spectrum that most users do
not have.  At the very least, this estimate should be be interpreted as a
minimal estimate of the noise level in <span class="math notranslate nohighlight">\(\chi(k)\)</span>.</p>
<p>The estimate for the output value <strong>kmax_suggest</strong> has a tendency to be
pessimistic in how far out the <span class="math notranslate nohighlight">\(\chi(k)\)</span> data goes before being
dominated by noise, but has the advantage of being an impartial measure of
data quality. It is particularly pessimistic for extremely good data.  Then
again, considering that the estimate for <span class="math notranslate nohighlight">\(\epsilon\)</span> is probably too
small, the estimate may not be that bad.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="preedge.html" title="11.2. XAFS: Pre-edge Subtraction, Normalization, and data treatment"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="11. XAFS Analysis"
             >previous</a> |</li>
   <li>[<a href="../index.html"> Larch</a>|</li>
   <li><a href="../getting_started.html"> Getting Started</a>|</li>
   <li><a href="index.html">XAFS Analysis</a>|</li>
   <li><a href="../xray/index.html">X-ray Databases</a>|</li>
   <li><a href="../xrf/index.html">XRF Analysis</a>|</li>
   <li><a href="../fitting/index.html">Curve Fitting</a>|</li>

          <li class="nav-item nav-item-1"><a href="index.html" >11. XAFS Analysis</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Matthew Newville, The University of Chicago, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>